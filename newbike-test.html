<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Sell Bike & Car</title>
  <style>
    body { font-family: Arial; padding: 20px; }
    label { display: block; margin-top: 10px; }
    input, select, button { padding: 6px; width: 100%; }
    .modal-content { max-width: 500px; margin: auto; }
  </style>
</head>
<body>

<h2>Post Your Bike or Car for Sale</h2>

<form id="postForm">

  <!-- Main Category -->
  <label>Category</label>
  <select id="category" required>
    <option value="">-- Select --</option>
    <option value="Bike">Bike</option>
    <option value="Car">Car</option>
  </select>

  <!-- Sub Category / Brand -->
  <label>Brand</label>
  <select id="brand" required>
    <!-- JS से change होगा -->
  </select>

  <label>Model Name</label>
  <input type="text" id="model" required>

  <label>Year of Purchase</label>
  <input type="number" id="year" required>

  <label>Condition</label>
  <select id="condition" required>
    <option value="Excellent">Excellent</option>
    <option value="Good">Good</option>
    <option value="Average">Average</option>
    <option value="Needs Repair">Needs Repair</option>
  </select>

  <label>Price (₹)</label>
  <input type="number" id="price" required>

  <label>City / Location</label>
  <input type="text" id="location" required>

  <label>Contact Number</label>
  <input type="tel" id="contact" required>

  <label>Upload Images (Multiple)</label>
  <input type="file" id="images" accept="image/*" multiple required>

  <button type="submit">Post Now</button>
</form>

<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-storage-compat.js"></script>

<script>
  // 🔥 Your Firebase config
  const firebaseConfig = {
    apiKey: "AIzaSyAAOYtvC0kiu_vZTYuQ8phPyMqTEFJj9O0",
    authDomain: "new-bike-59133.firebaseapp.com",
    projectId: "new-bike-59133",
    storageBucket: "new-bike-59133.appspot.com",
    messagingSenderId: "966945954091",
    appId: "1:966945954091:web:c1387e3a27af68aef3cd6e"
  };
  firebase.initializeApp(firebaseConfig);
  const db = firebase.firestore();
  const storage = firebase.storage();

  // 🔁 Brand options based on category
  const bikeBrands = ["Hero", "Honda", "Bajaj", "TVS", "Yamaha", "Royal Enfield", "Suzuki", "KTM", "Electric Bike", "Scooter"];
  const carBrands = ["Maruti", "Hyundai", "Tata", "Honda", "Mahindra", "Toyota", "Kia", "Ford", "Skoda", "Renault", "BMW", "Mercedes"];

  const categorySelect = document.getElementById("category");
  const brandSelect = document.getElementById("brand");

  categorySelect.addEventListener("change", function () {
    brandSelect.innerHTML = "";
    let arr = categorySelect.value === "Bike" ? bikeBrands : carBrands;
    arr.forEach(b => {
      let opt = document.createElement("option");
      opt.value = b;
      opt.textContent = b;
      brandSelect.appendChild(opt);
    });
  });

  // 📤 Form submit
  document.getElementById("postForm").addEventListener("submit", async function (e) {
    e.preventDefault();

    const category = document.getElementById("category").value;
    const brand = document.getElementById("brand").value;
    const model = document.getElementById("model").value;
    const year = document.getElementById("year").value;
    const condition = document.getElementById("condition").value;
    const price = document.getElementById("price").value;
    const location = document.getElementById("location").value;
    const contact = document.getElementById("contact").value;
    const files = document.getElementById("images").files;

    if (files.length === 0) {
      alert("Please upload at least one image.");
      return;
    }

    // 🖼 Upload all images
    let imageUrls = [];
    for (let i = 0; i < files.length; i++) {
      const file = files[i];
      const storageRef = storage.ref().child(`imgb/${Date.now()}_${file.name}`);
      await storageRef.put(file);
      const url = await storageRef.getDownloadURL();
      imageUrls.push(url);
    }

    // 💾 Save to Firestore
    await db.collection("vehiclePosts").add({
      category,
      brand,
      model,
      year,
      condition,
      price,
      location,
      contact,
      images: imageUrls,
      timestamp: firebase.firestore.FieldValue.serverTimestamp()
    });

    alert("Post uploaded successfully!");
    document.getElementById("postForm").reset();
    brandSelect.innerHTML = "";
  });
</script>

</body>
</html>
