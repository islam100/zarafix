<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>New Bike & Car Sale</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100">

<!-- ðŸ”¥ Post Form Modal -->
<div id="postModal" class="fixed inset-0 hidden bg-black bg-opacity-50 flex items-center justify-center z-50">
  <div class="bg-white rounded-lg shadow-lg w-full max-w-lg max-h-[90vh] overflow-y-auto p-6">
    <h2 class="text-xl font-bold mb-4">ðŸš˜ Post Your Vehicle</h2>
    <form id="postForm" class="space-y-4">

      <label class="block">Category</label>
      <select id="category" class="w-full border p-2 rounded" required>
        <option value="Bike">Bike</option>
        <option value="Car">Car</option>
      </select>

      <label class="block">Sub-Category</label>
      <select id="subCategory" class="w-full border p-2 rounded" required>
        <option value="New">New</option>
        <option value="Used">Used</option>
        <option value="Electric">Electric</option>
      </select>

      <label class="block">Brand</label>
      <input type="text" id="brand" class="w-full border p-2 rounded" placeholder="e.g. Hero, Honda, Maruti" required>

      <label class="block">Model</label>
      <input type="text" id="model" class="w-full border p-2 rounded" placeholder="e.g. Splendor+, Swift" required>

      <label class="block">Year</label>
      <input type="number" id="year" class="w-full border p-2 rounded" placeholder="e.g. 2020" required>

      <label class="block">Condition</label>
      <select id="condition" class="w-full border p-2 rounded" required>
        <option value="Excellent">Excellent</option>
        <option value="Good">Good</option>
        <option value="Average">Average</option>
        <option value="Needs Repair">Needs Repair</option>
      </select>

      <label class="block">Price (â‚¹)</label>
      <input type="number" id="price" class="w-full border p-2 rounded" placeholder="Enter price" required>

      <label class="block">Location</label>
      <input type="text" id="location" class="w-full border p-2 rounded" placeholder="City / Area" required>

      <label class="block">Contact Number</label>
      <input type="tel" id="contact" class="w-full border p-2 rounded" placeholder="Mobile Number" required>

      <label class="block">Upload Images (Max 5)</label>
      <input type="file" id="images" class="w-full border p-2 rounded" accept="image/*" multiple required>

      <button type="submit" class="bg-blue-600 text-white px-4 py-2 rounded w-full">Submit</button>
    </form>
  </div>
</div>

<script>
  // ðŸ”‘ Firebase Config
  const firebaseConfig = {
    apiKey: "AIzaSyAAOYtvC0kiu_vZTYuQ8phPyMqTEFJj9O0",
    authDomain: "new-bike-59133.firebaseapp.com",
    projectId: "new-bike-59133",
    storageBucket: "new-bike-59133.appspot.com",
    messagingSenderId: "966945954091",
    appId: "1:966945954091:web:c1387e3a27af68aef3cd6e"
  };
  firebase.initializeApp(firebaseConfig);
  const db = firebase.firestore();

  const form = document.getElementById("postForm");

  form.addEventListener("submit", async (e) => {
    e.preventDefault();

    const category = document.getElementById("category").value;
    const subCategory = document.getElementById("subCategory").value;
    const brand = document.getElementById("brand").value;
    const model = document.getElementById("model").value;
    const year = document.getElementById("year").value;
    const condition = document.getElementById("condition").value;
    const price = document.getElementById("price").value;
    const location = document.getElementById("location").value;
    const contact = document.getElementById("contact").value;
    const files = document.getElementById("images").files;

    if (files.length > 5) {
      alert("You can upload max 5 images");
      return;
    }

    // ðŸ–¼ Upload to ImgBB
    const uploadedUrls = [];
    for (let file of files) {
      const formData = new FormData();
      formData.append("image", file);

      const res = await fetch("https://api.imgbb.com/1/upload?key=4dc5e5cb7654ffc308d5ca45452b014b", {
        method: "POST",
        body: formData
      });
      const data = await res.json();
      if (data.success) uploadedUrls.push(data.data.url);
    }

    // ðŸ”¥ Save to Firestore
    await db.collection("posts").add({
      category, subCategory, brand, model, year,
      condition, price, location, contact,
      images: uploadedUrls,
      status: "pending",
      createdAt: firebase.firestore.FieldValue.serverTimestamp()
    });

    alert("âœ… Vehicle posted successfully (waiting for admin approval)");
    form.reset();
  });
</script>

</body>
</html>
