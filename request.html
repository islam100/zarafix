<!DOCTYPE html>
<html>
<head>
  <title>My Requests - ZaraFix</title>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
</head>
<body>
  <h2>मेरे द्वारा किए गए Request:</h2>
  <div id="requestList"></div>

  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyCH17_8W_UPmPt4KqpCaV7BpN6KsA4a67E",
      authDomain: "zara-fix.firebaseapp.com",
      databaseURL: "https://zara-fix-default-rtdb.firebaseio.com",
      projectId: "zara-fix",
      storageBucket: "zara-fix.appspot.com",
      messagingSenderId: "476473209200",
      appId: "1:476473209200:web:9f6efe6c32fd4248949fb5"
    };
    firebase.initializeApp(firebaseConfig);

    firebase.auth().onAuthStateChanged(function(user) {
      if (user) {
        const userId = user.uid;
        const requestRef = firebase.database().ref("requests/" + userId);

        requestRef.once("value", snapshot => {
          const requests = snapshot.val();
          const container = document.getElementById("requestList");
          container.innerHTML = "";

          if (requests) {
            Object.entries(requests).forEach(([requestId, requestData]) => {
              let html = `<div style="border:1px solid #ccc; padding:10px; margin:10px;">
                <strong>काम:</strong> ${requestData.category}<br>
                <strong>विवरण:</strong> ${requestData.description}<br>`;

              if (requestData.acceptedBy) {
                const accepterIds = Object.keys(requestData.acceptedBy);
                html += `<strong>Accept किया:</strong> ${accepterIds.join(", ")}`;
              } else {
                html += `<strong>Accept किया:</strong> अभी किसी ने नहीं किया`;
              }

              html += "</div>";
              container.innerHTML += html;
            });
          } else {
            container.innerHTML = "आपने अभी कोई request नहीं की है।";
          }
        });

      } else {
        alert("कृपया पहले लॉगिन करें");
        window.location.href = "index.html";
      }
    });
  </script>
</body>
</html>
