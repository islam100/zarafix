<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Card Approval System</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
</head>
<body class="bg-gray-100">

  <!-- Header -->
  <header class="bg-blue-600 text-white p-4 flex justify-between items-center shadow-lg">
    <h1 class="text-xl font-bold">ZaraFix</h1>
    <button onclick="location.reload()" class="bg-white text-blue-600 px-4 py-2 rounded-lg shadow-md hover:scale-105 transition">Home</button>
  </header>

  <!-- Cards Container -->
  <div id="cardContainer" class="grid grid-cols-1 md:grid-cols-3 gap-6 p-6"></div>

  <script>
    // Firebase config
    const firebaseConfig = {
      apiKey: "AIzaSyD7ZqL-PVuFdd8rMVIyW7CgHQjPRGHD2h8",
      authDomain: "zara-fix-2e35a.firebaseapp.com",
      databaseURL: "https://zara-fix-2e35a-default-rtdb.firebaseio.com",
      projectId: "zara-fix-2e35a",
      storageBucket: "zara-fix-2e35a.appspot.com",
      messagingSenderId: "1234567890",
      appId: "1:1234567890:web:abcdef123456"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();
    const auth = firebase.auth();

    // Random colors for cards
    const colors = ["bg-red-300", "bg-green-300", "bg-yellow-300", "bg-blue-300", "bg-purple-300", "bg-pink-300"];

    auth.signInWithPopup(new firebase.auth.GoogleAuthProvider()).then(user => {
      const currentUser = user.user;

      db.ref("posts").on("value", snapshot => {
        const data = snapshot.val();
        const container = document.getElementById("cardContainer");
        container.innerHTML = "";

        for (let id in data) {
          const post = data[id];
          const randomColor = colors[Math.floor(Math.random() * colors.length)];

          let cardContent = `
            <div class="p-4 rounded-2xl shadow-2xl transform hover:scale-105 transition ${randomColor}">
              <h2 class="text-lg font-bold">${post.title || "No Title"}</h2>
              <p class="text-sm">${post.description || ""}</p>
          `;

          if (post.approved === true) {
            cardContent += `<p class="mt-2 text-green-700 font-bold">✅ Approved</p>`;
          } else if (post.poster === currentUser.uid) {
            cardContent += `<p class="mt-2 text-red-700 font-bold">⏳ Wait for Approval</p>`;
          } else {
            continue; // unapproved post only visible to poster
          }

          cardContent += `</div>`;
          container.innerHTML += cardContent;
        }
      });
    });
  </script>
</body>
</html>
