<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>ZaraFix - Posts</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body { font-family: Arial, sans-serif; margin: 0; padding: 20px; background: #f0f0f5; }
    .btn { background: linear-gradient(135deg, #4facfe, #00f2fe); color: white; border: none;
           padding: 10px 20px; margin: 5px; border-radius: 12px; cursor: pointer;
           box-shadow: 0 4px 6px rgba(0,0,0,0.3); transition: 0.2s; }
    .btn:hover { transform: translateY(-3px); box-shadow: 0 8px 12px rgba(0,0,0,0.4); }
    .card { background: white; border-radius: 16px; padding: 20px; margin: 15px 0;
            box-shadow: 0 6px 12px rgba(0,0,0,0.2); transition: 0.3s; }
    .card:hover { transform: scale(1.02); }
    .admin-controls { margin-top: 10px; }
  </style>
</head>
<body>

  <h1>ZaraFix - Service Portal</h1>

  <!-- Login / Logout -->
  <button id="loginBtn" class="btn">Login with Google</button>
  <button id="logoutBtn" class="btn" style="display:none;">Logout</button>

  <!-- Post Form (only for logged-in users) -->
  <div id="postFormSection" style="display:none;">
    <h2>Create a Post</h2>
    <form id="postForm">
      <input type="text" id="title" placeholder="Title" required><br><br>
      <textarea id="description" placeholder="Description" required></textarea><br><br>
      <button type="submit" class="btn">Submit Post</button>
    </form>
  </div>

  <h2>All Posts</h2>
  <div id="posts"></div>

  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
  <script>
    // ðŸ”¹ Firebase Config
    const firebaseConfig = {
      apiKey: "YOUR_API_KEY",
      authDomain: "YOUR_PROJECT_ID.firebaseapp.com",
      databaseURL: "https://YOUR_PROJECT_ID.firebaseio.com",
      projectId: "YOUR_PROJECT_ID",
      storageBucket: "YOUR_PROJECT_ID.appspot.com",
      messagingSenderId: "SENDER_ID",
      appId: "APP_ID"
    };
    firebase.initializeApp(firebaseConfig);

    const auth = firebase.auth();
    const db = firebase.database();

    const loginBtn = document.getElementById('loginBtn');
    const logoutBtn = document.getElementById('logoutBtn');
    const postFormSection = document.getElementById('postFormSection');
    const postForm = document.getElementById('postForm');
    const postsDiv = document.getElementById('posts');

    const ADMIN_UID = "PUT_ADMIN_UID_HERE"; // ðŸ”¹ à¤…à¤ªà¤¨à¤¾ admin UID à¤¡à¤¾à¤²à¥‹

    // ðŸ”¹ Google Login
    loginBtn.onclick = () => {
      const provider = new firebase.auth.GoogleAuthProvider();
      auth.signInWithPopup(provider);
    };

    logoutBtn.onclick = () => auth.signOut();

    auth.onAuthStateChanged(user => {
      if (user) {
        loginBtn.style.display = "none";
        logoutBtn.style.display = "inline-block";
        postFormSection.style.display = "block";
      } else {
        loginBtn.style.display = "inline-block";
        logoutBtn.style.display = "none";
        postFormSection.style.display = "none";
      }
    });

    // ðŸ”¹ Submit Post
    postForm.addEventListener('submit', e => {
      e.preventDefault();
      const user = auth.currentUser;
      if (!user) return alert("Login first!");

      const newPost = {
        title: document.getElementById('title').value,
        description: document.getElementById('description').value,
        createdBy: user.uid,
        createdAt: Date.now()
      };

      db.ref("posts").push(newPost);
      postForm.reset();
    });

    // ðŸ”¹ Load Posts
    db.ref("posts").on("value", snapshot => {
      postsDiv.innerHTML = "";
      snapshot.forEach(child => {
        const post = child.val();
        const key = child.key;

        const card = document.createElement("div");
        card.className = "card";
        card.innerHTML = `<h3>${post.title}</h3><p>${post.description}</p>`;

        // Admin controls
        const user = auth.currentUser;
        if (user && user.uid === ADMIN_UID) {
          const controls = document.createElement("div");
          controls.className = "admin-controls";
          controls.innerHTML = `
            <button class="btn" onclick="deletePost('${key}')">Delete</button>
            <button class="btn" onclick="approvePost('${key}')">Approve</button>
          `;
          card.appendChild(controls);
        }

        postsDiv.appendChild(card);
      });
    });

    // ðŸ”¹ Delete Post (Admin)
    function deletePost(id) {
      db.ref("posts/" + id).remove();
    }

    // ðŸ”¹ Approve Post (Admin)
    function approvePost(id) {
      db.ref("posts/" + id).update({ approved: true });
    }
  </script>
</body>
</html>
