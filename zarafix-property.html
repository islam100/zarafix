<!DOCTYPE html>
<html lang="hi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Zara Property Listing</title>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
<style>
  body { font-family: Arial, sans-serif; margin:0; padding:0; background:#f5f5f5; }
  header { display:flex; justify-content:space-between; align-items:center; padding:10px 20px; background:#fff; box-shadow:0 2px 5px rgba(0,0,0,0.1);}
  h1 { margin:0; font-size:24px; color:#333; text-shadow: 2px 2px #aaa; }
  button { padding:8px 12px; margin:5px; border:none; border-radius:8px; cursor:pointer; box-shadow: 3px 3px 6px #ccc; transition:0.2s; }
  button:hover { transform: translateY(-2px); box-shadow: 5px 5px 10px #bbb; }
  #loginBtn { background:#4CAF50; color:white; }
  #propertyContainer { display:grid; grid-template-columns: repeat(auto-fill,minmax(250px,1fr)); gap:15px; padding:15px;}
  .card { background:white; border-radius:10px; overflow:hidden; box-shadow:0 4px 8px rgba(0,0,0,0.2); cursor:pointer; transition:0.3s; }
  .card:hover { transform: scale(1.03); }
  .card img { width:100%; height:200px; object-fit:contain; background:#eee; }
  .card-body { padding:10px; }
  .card-body h3 { margin:5px 0; font-size:18px; }
  .card-body p { margin:3px 0; font-size:14px; color:#555; }
  .btn-admin { background:#f44336; color:white; }
  #lightbox { position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.8); display:none; justify-content:center; align-items:center; z-index:1000; }
  #lightbox img { max-width:90%; max-height:90%; border-radius:10px; }
  #lightbox:active { display:none; }
</style>
</head>
<body>

<header>
  <h1>Zara Property Listing</h1>
  <button id="loginBtn">Admin Login</button>
</header>

<div id="propertyContainer"></div>

<div id="lightbox"><img src="" alt="Property"></div>

<script>
  // Firebase config
  const firebaseConfig = {
    apiKey: "AIzaSyDTj2n1yhr1sFmuyBZ-jUwOmx1YqAN5QjA",
    authDomain: "property-20d6d.firebaseapp.com",
    databaseURL: "https://property-20d6d-default-rtdb.firebaseio.com",
    projectId: "property-20d6d",
    storageBucket: "property-20d6d.appspot.com",
    messagingSenderId: "916859697394",
    appId: "1:916859697394:web:2a8f9ad2d62f8306dcb86b"
  };
  firebase.initializeApp(firebaseConfig);

  const db = firebase.database();
  const auth = firebase.auth();
  const adminEmail = "zarasamajiksevasanstha@gmail.com";

  const propertyContainer = document.getElementById("propertyContainer");
  const lightbox = document.getElementById("lightbox");
  const lightboxImg = lightbox.querySelector("img");
  let currentUser = null;

  // Admin login
  document.getElementById("loginBtn").addEventListener("click", ()=>{
    const provider = new firebase.auth.GoogleAuthProvider();
    auth.signInWithPopup(provider).then((result)=>{
      currentUser = result.user;
      alert("Logged in as "+currentUser.email);
      loadProperties();
    });
  });

  // Load properties
  function loadProperties() {
    db.ref("properties").once("value").then(snapshot=>{
      propertyContainer.innerHTML="";
      snapshot.forEach(snap=>{
        const prop = snap.val();
        if(!prop.approved && currentUser?.email!==adminEmail) return; // Only admin sees unapproved
        const card = document.createElement("div");
        card.className="card";
        card.innerHTML = `
          <img src="${prop.imageUrl}" alt="${prop.title}">
          <div class="card-body">
            <h3>${prop.title}</h3>
            <p>City: ${prop.city}</p>
            <p>Type: ${prop.type}</p>
            <p>Price: â‚¹${prop.price}</p>
            <p>${prop.description}</p>
            <p>Whatsapp: <a href="https://wa.me/${prop.whatsapp}" target="_blank">${prop.whatsapp}</a></p>
            ${currentUser?.email===adminEmail ? 
              `<button class="btn-admin" onclick="approveProperty('${snap.key}')">Approve</button>
               <button class="btn-admin" onclick="deleteProperty('${snap.key}')">Delete</button>` : ""}
          </div>
        `;
        card.querySelector("img").addEventListener("click", ()=>{
          lightboxImg.src = prop.imageUrl;
          lightbox.style.display="flex";
        });
        propertyContainer.appendChild(card);
      });
    });
  }

  // Approve property
  function approveProperty(key) {
    db.ref("properties/"+key).update({approved:true});
    loadProperties();
  }

  // Delete property
  function deleteProperty(key) {
    if(confirm("Are you sure to delete this property?")) {
      db.ref("properties/"+key).remove();
      loadProperties();
    }
  }

  // Lightbox close
  lightbox.addEventListener("click", ()=>{ lightbox.style.display="none"; });

  // Initial load
  loadProperties();
</script>
</body>
</html>
