<!DOCTYPE html>
<html>
<head>
  <title>üõ†Ô∏è ZaraFix - Request Form</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    body { font-family: Arial; background: #f5f5f5; text-align: center; padding: 20px; }
    .form-box {
      background: #fff;
      border-radius: 15px;
      padding: 20px;
      box-shadow: 5px 5px 15px rgba(0,0,0,0.2);
      max-width: 400px;
      margin: auto;
    }
    input, textarea {
      width: 90%;
      padding: 10px;
      margin: 10px auto;
      border-radius: 10px;
      border: 1px solid #ccc;
    }
    .btn3d {
      padding: 12px 20px;
      background: #008CBA;
      border: none;
      color: white;
      border-radius: 10px;
      box-shadow: 0 5px #666;
      transition: all 0.2s;
      cursor: pointer;
    }
    .btn3d:active {
      box-shadow: 0 2px #666;
      transform: translateY(4px);
    }
    #loginBtn { background: green; }
    #loginSection, #formSection { display: none; }
  </style>
</head>
<body>

  <h2>üõ†Ô∏è Submit Service Request</h2>

  <div id="loginSection">
    <p>Please login to continue.</p>
    <button id="loginBtn" class="btn3d">Login with Google</button>
  </div>

  <div id="formSection" class="form-box">
    <input type="text" id="name" placeholder="Your Name" required><br>
    <input type="text" id="category" placeholder="Category (e.g., Electrician)" required><br>
    <textarea id="description" placeholder="Describe your issue" required></textarea><br>
    <button onclick="submitRequest()" class="btn3d">Submit Request</button>
  </div>

  <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-database.js"></script>

  <script>
    const firebaseConfig = {
      apiKey: "YOUR_API_KEY",
      authDomain: "YOUR_AUTH_DOMAIN",
      databaseURL: "YOUR_DB_URL",
      projectId: "YOUR_PROJECT_ID",
      appId: "YOUR_APP_ID"
    };
    firebase.initializeApp(firebaseConfig);

    const auth = firebase.auth();
    const db = firebase.database();

    // üîê Login with Google
    document.getElementById("loginBtn").onclick = function() {
      const provider = new firebase.auth.GoogleAuthProvider();
      auth.signInWithPopup(provider);
    };

    // ‚úÖ Check Login Status
    auth.onAuthStateChanged(user => {
      if (user) {
        document.getElementById("loginSection").style.display = "none";
        document.getElementById("formSection").style.display = "block";
      } else {
        document.getElementById("loginSection").style.display = "block";
        document.getElementById("formSection").style.display = "none";
      }
    });

    // üì§ Submit Request to Firebase
    function submitRequest() {
      const user = auth.currentUser;
      if (!user) return alert("Please login first");

      const name = document.getElementById("name").value;
      const category = document.getElementById("category").value;
      const description = document.getElementById("description").value;

      if (!name || !category || !description) return alert("Please fill all fields.");

      const requestId = Date.now();
      const userId = user.uid;

      db.ref("requests/" + userId + "/" + requestId).set({
        name, category, description,
        timestamp: new Date().toISOString()
      }).then(() => {
        alert("Request submitted!");
        document.getElementById("name").value = "";
        document.getElementById("category").value = "";
        document.getElementById("description").value = "";
      }).catch(err => alert("Error: " + err.message));
    }
  </script>

</body>
</html>
