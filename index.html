<!DOCTYPE html>
<html lang="hi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Add Product - ZaraFix</title>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
<style>
  body { font-family:sans-serif; background:#0b1220; color:#fff; padding:20px;}
  .inpt { display:block; margin:10px 0; padding:10px; width:100%; border-radius:10px; border:none; }
  button { padding:10px 20px; border:none; border-radius:10px; background:#22c55e; color:#fff; cursor:pointer;}
</style>
</head>
<body>
<h2>Add Product</h2>
<input id="pName" placeholder="Product Name" class="inpt">
<input id="pCategory" placeholder="Category" class="inpt">
<input id="pPrice" placeholder="Price" type="number" class="inpt">
<input id="pWhats" placeholder="Shop WhatsApp" class="inpt">
<textarea id="pDesc" placeholder="Description" class="inpt"></textarea>
<input id="pImages" type="file" accept="image/*" multiple class="inpt">
<button id="submitProduct">Submit</button>
<p id="msg"></p>

<script>
const firebaseConfig = {
  apiKey: "AIzaSyAa8htkfGK-4D3cIQVyxT3o_8WMvghkr-8",
  authDomain: "loot-lo-15328.firebaseapp.com",
  databaseURL: "https://loot-lo-15328-default-rtdb.firebaseio.com",
  projectId: "loot-lo-15328",
  storageBucket: "loot-lo-15328.appspot.com",
  messagingSenderId: "677769861892",
  appId: "1:677769861892:web:bb235cb8479aeee9b58e51"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.database();
const IMGBB_KEY = "ff05d1b5c3b3e139253856f0ad1123df";

async function uploadToImgBB(file){
  const body = new FormData();
  body.append('key', IMGBB_KEY);
  body.append('image', file);
  const res = await fetch('https://api.imgbb.com/1/upload', { method:'POST', body });
  const data = await res.json();
  return data.data.display_url;
}

document.getElementById('submitProduct').onclick = async ()=>{
  const name = document.getElementById('pName').value.trim();
  const category = document.getElementById('pCategory').value.trim();
  const price = Number(document.getElementById('pPrice').value);
  const desc = document.getElementById('pDesc').value.trim();
  const whats = document.getElementById('pWhats').value.trim();
  const files = document.getElementById('pImages').files;

  if(!name || !category || !price || !whats || !files.length){
    document.getElementById('msg').textContent = 'Please fill all fields!';
    return;
  }

  document.getElementById('msg').textContent = 'Uploading...';
  const images = [];
  for(const f of files){ images.push(await uploadToImgBB(f)); }

  const id = db.ref('products').push().key;
  await db.ref('products/'+id).set({
    id, name, category, price, desc, whats, images, status:'approved', sold:false, createdAt: Date.now()
  });
  document.getElementById('msg').textContent = 'Product added!';
  document.querySelectorAll('.inpt, textarea').forEach(i=>i.value='');
  document.getElementById('pImages').value='';
};
</script>
</body>
</html>
