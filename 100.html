<!DOCTYPE html>
<html lang="hi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ZaraFix – Sale Offers</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;800&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg:#0b0d12; --card:#11141b; --card2:#151a24; --text:#e7ecf5; --muted:#9fb0cc;
      --b1:#7c6cff; --b2:#00e5ff; --ok:#24d26b; --warn:#ffb02e; --err:#ff3b3b;
      --shadow: 0 15px 30px rgba(0,0,0,.45), inset 0 1px 0 rgba(255,255,255,.02);
      --r2xl:22px;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0; font-family:Poppins,system-ui,Segoe UI,Arial,sans-serif; background:radial-gradient(1200px 800px at -10% -10%, rgba(124,108,255,.15), transparent 50%),radial-gradient(1000px 600px at 110% -20%, rgba(0,229,255,.12), transparent 50%),var(--bg); color:var(--text)}
    a{color:inherit; text-decoration:none}

    /* Header */
    .appbar{position:sticky; top:0; z-index:50; backdrop-filter: blur(10px); background:linear-gradient(180deg, rgba(15,17,24,.75), rgba(15,17,24,.35)); border-bottom:1px solid rgba(255,255,255,.06)}
    .appbar-inner{max-width:1200px; margin:0 auto; padding:10px 14px; display:flex; align-items:center; gap:12px}
    .logo{display:flex; align-items:center; gap:10px; user-select:none}
    .logo-badge{width:44px; height:44px; border-radius:14px; background:conic-gradient(from 200deg,var(--b1),var(--b2)); box-shadow:0 10px 24px rgba(0,229,255,.25), inset 0 -6px 20px rgba(0,0,0,.35)}
    .logo-text{font-weight:800; letter-spacing:.5px; font-size:26px; line-height:1; background:linear-gradient(90deg,#fff,#b0dfff,#86a0ff); -webkit-background-clip:text; background-clip:text; color:transparent; text-shadow:0 6px 30px rgba(0,229,255,.25)}
    .pill{display:flex; align-items:center; gap:10px; padding:8px 12px; border-radius:999px; background:linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.02)); border:1px solid rgba(255,255,255,.08); box-shadow:var(--shadow)}

    .menus{flex:1; display:flex; justify-content:center}
    .dropdown{position:relative}
    .dropdown>button{font-weight:600; border:none; cursor:pointer; color:var(--text); background:transparent; padding:10px 14px; border-radius:12px}
    .dropdown-list{position:absolute; top:100%; left:0; min-width:220px; margin-top:8px; display:none; flex-direction:column; background:var(--card2); border:1px solid rgba(255,255,255,.08); border-radius:16px; box-shadow:var(--shadow); overflow:hidden; z-index:60}
    .dropdown.open .dropdown-list{display:flex}
    .dropdown-list a{padding:12px 14px}
    .dropdown-list a:hover{background:rgba(255,255,255,.06)}

    .auth-area{display:flex; align-items:center; gap:8px}
    .btn-3d{appearance:none; border:none; cursor:pointer; color:#081018; font-weight:800; padding:10px 14px; border-radius:14px; background:linear-gradient(180deg,#8ef6ff,#44d2ff); box-shadow:0 10px 20px rgba(0,229,255,.35), inset 0 -8px 16px rgba(0,0,0,.25); transition:transform .08s ease, box-shadow .2s ease}
    .btn-3d:active{transform:translateY(2px); box-shadow:0 6px 14px rgba(0,229,255,.35), inset 0 -6px 14px rgba(0,0,0,.25)}
    .btn-ghost{background:linear-gradient(180deg, rgba(255,255,255,.12), rgba(255,255,255,.04)); color:var(--text)}
    .btn-danger{background:linear-gradient(180deg,#ff9a9a,#ff5252)}
    .btn-success{background:linear-gradient(180deg,#86ffcc,#24d26b)}

    .roles{display:flex; gap:6px}
    .tab{padding:8px 12px; border-radius:12px; font-weight:700; font-size:12px; opacity:.85; border:1px solid rgba(255,255,255,.08)}
    .tab.active{background:linear-gradient(180deg, rgba(255,255,255,.12), rgba(255,255,255,.04)); opacity:1}

    .wrap{max-width:1200px; margin:20px auto; padding:0 14px}

    /* Grid */
    .grid{display:grid; grid-template-columns:repeat(2,1fr); gap:12px}
    @media(min-width:820px){.grid{grid-template-columns:repeat(4,1fr)}}

    .card{position:relative; border-radius:var(--r2xl); background:linear-gradient(160deg, rgba(255,255,255,.04), rgba(255,255,255,.01)); border:1px solid rgba(255,255,255,.08); box-shadow:var(--shadow); overflow:hidden; user-select:none}
    .card.pending{outline:2px dashed rgba(255,59,59,.6); background:linear-gradient(160deg, rgba(255,59,59,.12), rgba(255,255,255,.03))}
    .card.rejected{outline:2px dashed rgba(255,59,59,.9); filter:saturate(.6) opacity(.9)}
    .badge{position:absolute; top:10px; left:10px; padding:6px 10px; border-radius:999px; font-size:11px; font-weight:800; letter-spacing:.3px; color:#081018}
    .badge.pending{background:linear-gradient(180deg,#ffd0d0,#ff7373)}
    .badge.approved{background:linear-gradient(180deg,#b8ffd9,#49e28c)}
    .badge.rejected{background:linear-gradient(180deg,#ffc2c2,#ff3b3b)}

    .media{position:relative; height:170px; background:#0d1117}
    .media img{width:100%; height:100%; object-fit:cover; display:block; pointer-events:none}
    .media .nav{position:absolute; top:50%; transform:translateY(-50%); width:100%; display:flex; justify-content:space-between; padding:0 6px}
    .icon-btn{width:34px; height:34px; border-radius:999px; display:grid; place-items:center; border:1px solid rgba(255,255,255,.25); background:rgba(0,0,0,.35); backdrop-filter:blur(4px); cursor:pointer; font-weight:900}

    .body{padding:12px}
    .name{font-weight:800; font-size:14px; line-height:1.3}
    .meta{font-size:12px; color:var(--muted); display:flex; gap:8px; margin:6px 0 10px; flex-wrap:wrap}
    .price{font-weight:900; font-size:16px}
    .discount{font-size:12px; font-weight:800; color:#ffe08a}
    .row{display:flex; gap:8px; align-items:center; flex-wrap:wrap}
    .row .grow{flex:1}
    .card-actions{display:flex; gap:8px; margin-top:10px}

    /* Modal */
    .modal{position:fixed; inset:0; display:none; align-items:center; justify-content:center; background:rgba(0,0,0,.6); z-index:70}
    .modal.show{display:flex}
    .modal-card{width:min(96vw,900px); border-radius:22px; overflow:hidden; background:var(--card2); border:1px solid rgba(255,255,255,.08); box-shadow:var(--shadow); position:relative}
    .close-btn{position:absolute; top:10px; right:10px; background:#ff4c4c; border:none; border-radius:50%; width:32px; height:32px; font-weight:900; cursor:pointer; color:#fff}
    .hint{font-size:12px; color:var(--muted)}
  </style>
</head>
<body>
  <header class="appbar">
    <div class="appbar-inner">
      <div class="logo">
        <div class="logo-badge"></div>
        <div class="logo-text">ZARA FIX</div>
      </div>
      <div class="menus">
        <div class="pill">
          <div class="dropdown" id="dd-services">
            <button>Services ▾</button>
            <div class="dropdown-list">
              <a href="#">All Services</a>
              <a href="#">Property</a>
              <a href="#">Ambulance</a>
              <a href="#">Home</a>
            </div>
          </div>
          <div class="dropdown" id="dd-info" style="margin-left:8px">
            <button>Info ▾</button>
            <div class="dropdown-list">
              <a href="#">Provider</a>
              <a href="#">About</a>
              <a href="#">Contact</a>
              <a href="#">Privacy Policy</a>
            </div>
          </div>
        </div>
      </div>
      <div class="auth-area">
        <div class="pill" style="gap:6px; margin-right:8px">
          <span class="tab active" data-tab="publicTab">Public</span>
          <span class="tab" data-tab="shopTab">Shopkeeper</span>
          <span class="tab hidden" id="adminTabBtn" data-tab="adminTab">Admin</span>
        </div>
        <button class="btn-3d btn-ghost" id="loginBtn">Login with Google</button>
        <button class="btn-3d btn-danger hidden" id="logoutBtn">Logout</button>
      </div>
    </div>
  </header>

  <div class="wrap">
    <section id="publicTab">
      <div class="grid" id="publicGrid"></div>
    </section>
    <section id="shopTab" class="hidden">
      <div class="panel">
        <h3>Sale Offer Add Karein</h3>
        <div class="hint">1–5 images • * required</div>
        <div class="field"><label>Product Name *</label><input id="pName" maxlength="80" /></div>
        <div class="field"><label>Category *</label><select id="pCategory"><option value="">Select...</option><option>bike</option><option>car</option><option>cloth</option><option>watch</option><option>mobile</option><option>pc</option></select></div>
        <div class="field"><label>Price (₹) *</label><input id="pPrice" type="number" min="1" /></div>
        <div class="field"><label>Discount (%)</label><input id="pDiscount" type="number" min="0" max="95" /></div>
        <div class="field"><label>WhatsApp Number *</label><input id="pWhats" type="tel" maxlength="15" placeholder="91xxxxxxxxxx" /></div>
        <div class="field"><label>Description</label><textarea id="pDesc"></textarea></div>
        <div class="field"><label>Images *</label><input id="pImages" type="file" accept="image/*" multiple /></div>
        <button id="submitProduct" class="btn-3d">Submit Offer</button>
        <span id="formMsg" class="hint"></span>
      </div>
      <div class="panel">
        <h3>Your Offers</h3>
        <div class="grid" id="myGrid"></div>
      </div>
    </section>
    <section id="adminTab" class="hidden">
      <div class="panel">
        <h3>Admin Dashboard</h3>
        <div class="row"><div class="chip" id="aTotal">Total: 0</div><div class="chip" id="aApproved">Approved: 0</div><div class="chip" id="aPending">Pending: 0</div><div class="chip" id="aRejected">Rejected: 0</div></div>
        <div class="grid" id="adminGrid"></div>
      </div>
    </section>
  </div>

  <div class="modal" id="modal"><div class="modal-card" id="modalCard"><button class="close-btn" id="closeModal">×</button></div></div>

  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

  <script>
    const firebaseConfig={apiKey:"AIzaSyAa8htkfGK-4D3cIQVyxT3o_8WMvghkr-8",authDomain:"loot-lo-15328.firebaseapp.com",databaseURL:"https://loot-lo-15328-default-rtdb.firebaseio.com",projectId:"loot-lo-15328",storageBucket:"loot-lo-15328.appspot.com",messagingSenderId:"677769861892",appId:"1:677769861892:web:bb235cb8479aeee9b58e51"};
    const ADMIN_EMAIL='zarasamajiksevasanstha@gmail.com';
    const IMGBB_KEY='ff05d1b5c3b3e139253856f0ad1123df';

    firebase.initializeApp(firebaseConfig);
    const auth=firebase.auth(); const db=firebase.database();
    const offersRef=db.ref('offers');
    const $=s=>document.querySelector(s),byId=id=>document.getElementById(id);
    const rupees=n=>'₹'+Number(n||0).toLocaleString('en-IN');

    // Tabs
    document.querySelectorAll('.tab').forEach(t=>t.addEventListener('click',()=>{document.querySelectorAll('.tab').forEach(x=>x.classList.remove('active'));t.classList.add('active');['publicTab','shopTab','adminTab'].forEach(id=>byId(id).classList.add('hidden'));byId(t.dataset.tab).classList.remove('hidden');}));

    // Login
    byId('loginBtn').onclick=async()=>{const provider=new firebase.auth.GoogleAuthProvider();await auth.signInWithPopup(provider);}
    byId('logoutBtn').onclick=()=>auth.signOut();

    auth.onAuthStateChanged(user=>{
      const logged=!!user;
      byId('loginBtn').classList.toggle('hidden',logged);
      byId('logoutBtn').classList.toggle('hidden',!logged);
      byId('shopTab').classList.toggle('hidden',!logged);
      const isAdmin=user&&user.email===ADMIN_EMAIL;
      byId('adminTabBtn').classList.toggle('hidden',!isAdmin);
      renderAll();
    });

    let ALL=[];
    offersRef.on('value',snap=>{
      const obj=snap.val()||{};
      ALL=Object.values(obj).sort((a,b)=>(b.createdAt||0)-(a.createdAt||0));
      updateStats(); renderAll();
    });

    function updateStats(){
      byId('aTotal').textContent=`Total: ${ALL.length}`;
      byId('aApproved').textContent=`Approved: ${ALL.filter(p=>p.status==='approved').length}`;
      byId('aPending').textContent=`Pending: ${ALL.filter(p=>p.status==='pending').length}`;
      byId('aRejected').textContent=`Rejected: ${ALL.filter(p=>p.status==='rejected').length}`;
    }

    async function uploadToImgBB(file){
      const body=new FormData();body.append('key',IMGBB_KEY);body.append('image',file);
      const res=await fetch('https://api.imgbb.com/1/upload',{method:'POST',body});
      const data=await res.json();
      if(!data||!data.data||!data.data.url) throw new Error('ImgBB upload failed');
      return data.data.url;
    }
    async function uploadMultiple(files){
      const list=Array.from(files).slice(0,5);const out=[];
      for(const f of list){out.push(await uploadToImgBB(f));}
      return out;
    }

    byId('submitProduct').onclick=async()=>{
      const u=auth.currentUser;if(!u){alert('Please login first');return
