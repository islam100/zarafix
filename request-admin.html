<h2>üéØ Posters Who Accepted Your Request</h2>
<div id="acceptedContainer">Loading...</div>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
  import { getDatabase, ref, onValue, get } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-database.js";
  import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";

  const firebaseConfig = {
    apiKey: "AIzaSyCH17_8W_UPmPt4KqpCaV7BpN6KsA4a67E",
    authDomain: "zara-fix.firebaseapp.com",
    databaseURL: "https://zara-fix-default-rtdb.firebaseio.com",
    projectId: "zara-fix",
    storageBucket: "zara-fix.appspot.com",
    messagingSenderId: "476473209200",
    appId: "1:476473209200:web:9f6efe6c32fd4248949fb5"
  };

  const app = initializeApp(firebaseConfig);
  const db = getDatabase(app);
  const auth = getAuth(app);

  onAuthStateChanged(auth, (user) => {
    if (user) {
      const userId = user.uid;
      const container = document.getElementById('acceptedContainer');
      container.innerHTML = 'Loading...';

      const userRequestsRef = ref(db, `requests/${userId}`);
      onValue(userRequestsRef, async (snapshot) => {
        if (!snapshot.exists()) {
          container.innerHTML = "‚ùå You have no requests.";
          return;
        }

        let postersShown = false;
        container.innerHTML = "";

        const requests = snapshot.val();
        for (const requestId in requests) {
          const request = requests[requestId];
          if (request.acceptedBy) {
            for (const posterId in request.acceptedBy) {
              const posterSnap = await get(ref(db, `posters/${posterId}`));
              if (posterSnap.exists()) {
                const poster = posterSnap.val();
                postersShown = true;
                const card = `
                  <div style="padding:15px;margin:10px;border-radius:10px;background:#e3f2fd;box-shadow:0 2px 6px rgba(0,0,0,0.2);">
                    üß∞ <b>${poster.name}</b> from ${poster.shop} <br>
                    üìû <a href="https://wa.me/91${poster.whatsapp}" target="_blank">WhatsApp Now</a>
                  </div>
                `;
                container.innerHTML += card;
              }
            }
          }
        }

        if (!postersShown) {
          container.innerHTML = "‚ùå No posters have accepted your request yet.";
        }
      });
    } else {
      document.getElementById('acceptedContainer').innerHTML = "‚ö†Ô∏è Please login first.";
    }
  });
</script>
