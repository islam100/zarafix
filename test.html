<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Zara Fix - Home</title>
<style>
  body, html { margin:0; padding:0; font-family: sans-serif; background: #e0f7ff; }
  header { display:flex; justify-content:space-between; align-items:center; padding:10px 20px; background:#0288d1; color:white; }
  .logo { font-weight:900; font-size:1.8rem; }
  #googleLoginBtn { background:#fff;color:#0288d1;font-weight:700;border:none;padding:6px 12px;border-radius:6px;cursor:pointer; }
  .dropdown { position:relative; display:inline-block; }
  .dropdown-content { display:none; position:absolute; right:0; background:#fff; min-width:150px; box-shadow:0 2px 6px rgba(0,0,0,0.2); z-index:10; }
  .dropdown-content button { width:100%; border:none; background:none; padding:8px 10px; cursor:pointer; text-align:left; }
  .dropdown:hover .dropdown-content { display:block; }
  #sliderImagesDiv { margin:20px auto; width:90%; max-width:600px; height:300px; background:#ccc; display:flex; justify-content:center; align-items:center; overflow:hidden; position:relative; border-radius:12px; }
  #sliderImagesDiv img { width:100%; height:100%; object-fit:cover; border-radius:12px; }
  #adminControls { position:absolute; top:10px; left:10px; display:none; z-index:5; }
  #adminControls input[type=file] { display:block; margin-bottom:5px; }
  #adminControls button { margin-right:5px; }
  footer { display:flex; justify-content:center; gap:20px; padding:10px 0; background:#0288d1; color:white; position:fixed; bottom:0; width:100%; }
  footer button { background:#fff; color:#0288d1; border:none; padding:6px 12px; border-radius:6px; cursor:pointer; font-weight:700; }
</style>
</head>
<body>

<header>
  <div class="logo">Zara Fix</div>
  <div class="dropdown">
    <button id="menuBtn">Menu</button>
    <div class="dropdown-content">
      <button onclick="alert('Option 1')">Option 1</button>
      <button onclick="alert('Option 2')">Option 2</button>
      <button onclick="alert('Option 3')">Option 3</button>
    </div>
  </div>
  <button id="googleLoginBtn">Login</button>
</header>

<div id="sliderImagesDiv">
  <div id="adminControls">
    <input type="file" id="imageUpload">
    <button id="uploadBtn">Upload</button>
    <button id="deleteBtn">Delete Current</button>
  </div>
</div>

<footer>
  <button onclick="alert('About')">About</button>
  <button onclick="alert('Contact')">Contact</button>
  <button onclick="alert('Privacy Policy')">Privacy Policy</button>
</footer>

<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-storage.js"></script>

<script>
  // Firebase config
  const firebaseConfig = {
    apiKey: "AIzaSyD7ZqL-PVuFdd8rMVIyW7CgHQjPRGHD2h8",
    authDomain: "zara-fix-2e35a.firebaseapp.com",
    projectId: "zara-fix-2e35a",
    storageBucket: "zara-fix-2e35a.appspot.com",
    messagingSenderId: "636550144008",
    appId: "1:636550144008:web:a849496ad1d1557d7ab1bd",
    databaseURL: "https://zara-fix-2e35a-default-rtdb.firebaseio.com"
  };

  firebase.initializeApp(firebaseConfig);
  const auth = firebase.auth();
  const db = firebase.database();
  const storage = firebase.storage();

  const loginBtn = document.getElementById('googleLoginBtn');
  const sliderImagesDiv = document.getElementById('sliderImagesDiv');
  const adminControls = document.getElementById('adminControls');
  const imageUpload = document.getElementById('imageUpload');
  const uploadBtn = document.getElementById('uploadBtn');
  const deleteBtn = document.getElementById('deleteBtn');

  let sliderImages = [];
  let currentIndex = 0;

  function loadSlider(){
    sliderImagesDiv.querySelectorAll('img').forEach(img=>img.remove());
    sliderImages = [];
    db.ref('slider').once('value').then(snapshot=>{
      snapshot.forEach(child=>{
        sliderImages.push({key: child.key, url: child.val().url});
      });
      if(sliderImages.length > 0){
        const img = document.createElement('img');
        img.src = sliderImages[0].url;
        sliderImagesDiv.appendChild(img);
        currentIndex = 0;
      }
    });
  }

  // Auto slide every 3 sec
  setInterval(()=>{
    if(sliderImages.length < 2) return;
    currentIndex = (currentIndex+1)%sliderImages.length;
    const img = sliderImagesDiv.querySelector('img');
    if(img) img.src = sliderImages[currentIndex].url;
  },3000);

  // Admin upload
  uploadBtn.addEventListener('click', ()=>{
    if(!imageUpload.files[0]) return alert('Select file');
    const file = imageUpload.files[0];
    const storageRef = storage.ref('slider/'+Date.now()+'_'+file.name);
    storageRef.put(file).then(snapshot=>{
      snapshot.ref.getDownloadURL().then(url=>{
        const newKey = db.ref('slider').push().key;
        db.ref('slider/'+newKey).set({url:url, timestamp:Date.now()});
        loadSlider();
        alert('Image uploaded');
      });
    });
  });

  // Admin delete
  deleteBtn.addEventListener('click', ()=>{
    if(sliderImages.length==0) return;
    const keyToDelete = sliderImages[currentIndex].key;
    db.ref('slider/'+keyToDelete).remove().then(()=>{
      loadSlider();
      alert('Image deleted');
    });
  });

  // Google login
  loginBtn.addEventListener('click', ()=>{
    if(auth.currentUser){
      auth.signOut();
    } else {
      const provider = new firebase.auth.GoogleAuthProvider();
      auth.signInWithPopup(provider).catch(err=>alert(err.message));
    }
  });

  auth.onAuthStateChanged(user=>{
    if(user){
      loginBtn.textContent='Logout';
      // check admin
      db.ref('admins/'+user.uid).once('value').then(snap=>{
        if(snap.exists()){
          adminControls.style.display='block';
        } else {
          adminControls.style.display='none';
        }
      });
    } else {
      loginBtn.textContent='Login';
      adminControls.style.display='none';
    }
    loadSlider();
  });

</script>
</body>
</html>
