<!DOCTYPE html>
<html lang="hi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>ZaraFix All Service</title>

<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-storage.js"></script>

<style>
/* Screen lock */
html, body {
  margin: 0;
  padding: 0;
  overflow: hidden; /* scrolling lock */
  height: 100%;
  font-family: Arial, sans-serif;
  background: #f4f4f4;
}

/* Header */
header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 12px 20px;
  background: white;
  box-shadow: 0 2px 5px rgba(0,0,0,0.1);
}

/* Logo */
.logo {
  font-size: 3rem;
  font-weight: bold;
  background: linear-gradient(45deg, red, orange, yellow, green, blue, indigo, violet);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  text-shadow: 2px 2px 6px rgba(0,0,0,0.3);
}

/* Dropdown Menu */
nav {
  position: relative;
}

.menu-btn {
  background: #333;
  color: white;
  padding: 8px 14px;
  border: none;
  border-radius: 5px;
  cursor: pointer;
}

.menu-content {
  display: none;
  position: absolute;
  right: 0;
  background: white;
  min-width: 150px;
  box-shadow: 0 2px 5px rgba(0,0,0,0.2);
  border-radius: 5px;
}

.menu-content a {
  display: block;
  padding: 8px 10px;
  color: #333;
  text-decoration: none;
}

.menu-content a:hover {
  background: #eee;
}

nav:hover .menu-content {
  display: block;
}

/* Buttons */
#loginBtn, #logoutBtn {
  padding: 6px 14px;
  border: none;
  border-radius: 5px;
  cursor: pointer;
}
#loginBtn { background: #28a745; color: white; }
#logoutBtn { background: #dc3545; color: white; }

/* Slider */
.slider {
  width: 100%;
  height: calc(100% - 80px);
  background: #000;
  display: flex;
  align-items: center;
  justify-content: center;
}

.slider img {
  max-width: 100%;
  max-height: 100%;
  object-fit: contain;
}

/* Admin Controls */
.admin-controls {
  position: absolute;
  bottom: 10px;
  left: 50%;
  transform: translateX(-50%);
  text-align: center;
}

.admin-controls button {
  padding: 8px 14px;
  margin: 5px;
  border: none;
  border-radius: 5px;
  cursor: pointer;
}

.upload-btn { background: #28a745; color: white; }
.delete-btn { background: #dc3545; color: white; }

/* Progress */
#uploadProgress {
  text-align: center;
  font-weight: bold;
  color: white;
  background: rgba(0,0,0,0.5);
  padding: 5px;
  border-radius: 5px;
}
</style>
</head>

<body>

<header>
  <div class="logo">ZaraFix</div>
  <nav>
    <button class="menu-btn">Menu â–¼</button>
    <div class="menu-content">
      <a href="#">Home</a>
      <a href="#">Services</a>
      <a href="#">Contact</a>
      <a href="#">About</a>
    </div>
  </nav>
  <div>
    <button id="loginBtn">Login</button>
    <button id="logoutBtn" style="display:none;">Logout</button>
  </div>
</header>

<div class="slider" id="imageSlider">
  <div id="uploadProgress"></div>
</div>

<div class="admin-controls" id="adminControls" style="display:none;">
  <button class="upload-btn" id="adminUploadBtn">Upload Image</button>
  <button class="delete-btn" id="adminDeleteBtn">Delete Image</button>
</div>

<script>
// Firebase config
const firebaseConfig = {
  apiKey: "AIzaSyD7ZqL-PVuFdd8rMVIyW7CgHQjPRGHD2h8",
  authDomain: "zara-fix-2e35a.firebaseapp.com",
  projectId: "zara-fix-2e35a",
  storageBucket: "zara-fix-2e35a.appspot.com",
  messagingSenderId: "636550144008",
  appId: "1:636550144008:web:a849496ad1d1557d7ab1bd"
};
firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();
const storage = firebase.storage();

const adminEmail = "zarasamajiksevasanstha@gmail.com";
let sliderImages = [];
let currentIndex = 0;

// Login
document.getElementById('loginBtn').onclick = () => {
  const provider = new firebase.auth.GoogleAuthProvider();
  auth.signInWithPopup(provider).catch(console.error);
};
document.getElementById('logoutBtn').onclick = () => auth.signOut();

// Auth state
auth.onAuthStateChanged(user => {
  if (user) {
    document.getElementById('loginBtn').style.display = "none";
    document.getElementById('logoutBtn').style.display = "inline-block";
    if (user.email === adminEmail) {
      document.getElementById('adminControls').style.display = "block";
    }
  } else {
    document.getElementById('loginBtn').style.display = "inline-block";
    document.getElementById('logoutBtn').style.display = "none";
    document.getElementById('adminControls').style.display = "none";
  }
});

// Upload (unlimited & fast)
document.getElementById('adminUploadBtn').onclick = () => {
  let input = document.createElement('input');
  input.type = "file";
  input.accept = "image/*";
  input.onchange = () => {
    const file = input.files[0];
    if (!file) return;

    const storageRef = storage.ref('slider/' + Date.now() + "_" + file.name);
    const uploadTask = storageRef.put(file);

    uploadTask.on('state_changed',
      (snapshot) => {
        let progress = (snapshot.bytesTransferred / snapshot.totalBytes) * 100;
        document.getElementById('uploadProgress').innerText = `Uploading... ${Math.round(progress)}%`;
      },
      (error) => {
        console.error(error);
        document.getElementById('uploadProgress').innerText = "Upload Failed!";
      },
      () => {
        document.getElementById('uploadProgress').innerText = "Upload Complete!";
        setTimeout(() => document.getElementById('uploadProgress').innerText = "", 2000);
        loadSliderImages();
      }
    );
  };
  input.click();
};

// Delete
document.getElementById('adminDeleteBtn').onclick = async () => {
  if (sliderImages.length === 0) return;
  const imgUrl = sliderImages[currentIndex];
  const filePath = decodeURIComponent(imgUrl.split("/o/")[1].split("?")[0]);
  document.getElementById('uploadProgress').innerText = "Deleting...";
  await storage.ref(filePath).delete();
  document.getElementById('uploadProgress').innerText = "Deleted!";
  setTimeout(() => document.getElementById('uploadProgress').innerText = "", 2000);
  loadSliderImages();
};

// Load images
async function loadSliderImages() {
  sliderImages = [];
  const list = await storage.ref('slider').listAll();
  for (let item of list.items) {
    const url = await item.getDownloadURL();
    sliderImages.push(url);
  }
  currentIndex = 0;
  showImage();
}

function showImage() {
  if (sliderImages.length === 0) {
    document.getElementById('imageSlider').innerHTML = "<p style='color:white;'>No Images</p>";
    return;
  }
  document.getElementById('imageSlider').innerHTML = `<img src="${sliderImages[currentIndex]}"> <div id="uploadProgress"></div>`;
}

// Auto slide
setInterval(() => {
  if (sliderImages.length > 1) {
    currentIndex = (currentIndex + 1) % sliderImages.length;
    showImage();
  }
}, 3000);

loadSliderImages();
</script>
</body>
</html>
