<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Zara Fix</title>
<style>
  body, html { margin:0; padding:0; font-family: Arial, sans-serif; background: #f0f0f0; }
  /* Header */
  .header { display:flex; justify-content:space-between; align-items:center; padding:10px 20px; background:#4285F4; color:white; position:fixed; width:100%; top:0; z-index:1000; }
  .logo { font-size:1.5rem; font-weight:bold; }
  .login-btn { padding:6px 12px; border:none; border-radius:6px; cursor:pointer; background:white; color:#4285F4; font-weight:bold; }
  /* Dropdown menu */
  .dropdown { position:relative; display:inline-block; }
  .dropdown-content { display:none; position:absolute; background:#fff; min-width:180px; box-shadow:0 4px 8px rgba(0,0,0,0.2); z-index:1; border-radius:6px; }
  .dropdown-content button { width:100%; padding:10px; border:none; background:none; text-align:left; cursor:pointer; }
  .dropdown:hover .dropdown-content { display:block; }
  /* Slider Box */
  .slider-container { max-width:600px; margin:100px auto 50px auto; position:relative; border-radius:10px; overflow:hidden; box-shadow:0 5px 15px rgba(0,0,0,0.3); background:#fff; }
  .slider-img { width:100%; height:300px; object-fit:cover; }
  .slider-admin { position:absolute; top:10px; right:10px; display:flex; gap:5px; }
  .slider-admin button { padding:6px 10px; border:none; border-radius:6px; cursor:pointer; background:#4285F4; color:white; font-weight:bold; }
  /* Bottom 3 buttons */
  .bottom-buttons { display:flex; justify-content:center; gap:20px; margin:20px 0; }
  .bottom-buttons button { padding:10px 20px; border:none; border-radius:6px; cursor:pointer; background:#4285F4; color:white; font-weight:bold; }
</style>
</head>
<body>

<div class="header">
  <div class="logo">Zara Fix</div>
  <div>
    <div class="dropdown">
      <button class="login-btn" id="googleLoginBtn">Google Login</button>
      <div class="dropdown-content" id="menuButtons">
        <button onclick="location.href='recharge.html'">Recharge Request</button>
        <button onclick="location.href='requestbottun.html'">Service Request</button>
        <button onclick="location.href='2poster.html'">Service Provider</button>
        <button onclick="location.href='property-index.html'">Real Estate</button>
        <button onclick="location.href='admin-dashboard.html'">Admin Dashboard</button>
      </div>
    </div>
  </div>
</div>

<div class="slider-container" id="sliderBox">
  <img src="" class="slider-img" id="sliderImage">
  <div class="slider-admin" id="sliderAdminButtons" style="display:none;">
    <button id="uploadImgBtn">Upload</button>
    <button id="deleteImgBtn">Delete</button>
  </div>
</div>

<div class="bottom-buttons">
  <button onclick="alert('About')">About</button>
  <button onclick="alert('Contact')">Contact</button>
  <button onclick="alert('Privacy Policy')">Privacy Policy</button>
</div>

<!-- Firebase SDKs -->
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-storage.js"></script>

<script>
  // Firebase config
  const firebaseConfig = {
    apiKey: "AIzaSyD7ZqL-PVuFdd8rMVIyW7CgHQjPRGHD2h8",
    authDomain: "zara-fix-2e35a.firebaseapp.com",
    projectId: "zara-fix-2e35a",
    storageBucket: "zara-fix-2e35a.appspot.com",
    messagingSenderId: "636550144008",
    appId: "1:636550144008:web:a849496ad1d1557d7ab1bd",
    databaseURL: "https://zara-fix-2e35a-default-rtdb.firebaseio.com/"
  };
  firebase.initializeApp(firebaseConfig);
  const auth = firebase.auth();
  const db = firebase.database();
  const storage = firebase.storage();

  const loginBtn = document.getElementById('googleLoginBtn');
  const menuButtons = document.getElementById('menuButtons');
  const sliderImage = document.getElementById('sliderImage');
  const sliderAdminButtons = document.getElementById('sliderAdminButtons');
  let currentSlider = 0;
  let sliderUrls = [];

  // Login/Logout
  loginBtn.addEventListener('click', ()=>{
    if(auth.currentUser){
      auth.signOut();
    }else{
      const provider = new firebase.auth.GoogleAuthProvider();
      auth.signInWithPopup(provider);
    }
  });

  auth.onAuthStateChanged(user=>{
    if(user){
      loginBtn.textContent = 'Logout';
      // Check if admin
      db.ref('admins/'+user.uid).once('value').then(snap=>{
        if(snap.exists()){
          sliderAdminButtons.style.display='flex';
        }
      });
    }else{
      loginBtn.textContent = 'Google Login';
      sliderAdminButtons.style.display='none';
    }
  });

  // Load slider images from database
  function loadSlider(){
    db.ref('slider').once('value').then(snap=>{
      sliderUrls = [];
      snap.forEach(child=>{
        sliderUrls.push(child.val().url);
      });
      if(sliderUrls.length>0){
        sliderImage.src = sliderUrls[0];
      }
    });
  }
  loadSlider();

  // Auto slide
  setInterval(()=>{
    if(sliderUrls.length>0){
      currentSlider = (currentSlider+1)%sliderUrls.length;
      sliderImage.src = sliderUrls[currentSlider];
    }
  },4000);

  // Admin upload
  document.getElementById('uploadImgBtn').addEventListener('click', ()=>{
    const fileInput = document.createElement('input');
    fileInput.type='file';
    fileInput.accept='image/*';
    fileInput.onchange = e=>{
      const file = e.target.files[0];
      const timestamp = Date.now();
      const storageRef = storage.ref('slider/'+timestamp+'_'+file.name);
      storageRef.put(file).then(snapshot=>{
        snapshot.ref.getDownloadURL().then(url=>{
          db.ref('slider/img'+timestamp).set({url:url, timestamp:timestamp}).then(()=>{
            alert('Image uploaded!');
            loadSlider();
          });
        });
      });
    };
    fileInput.click();
  });

  // Admin delete
  document.getElementById('deleteImgBtn').addEventListener('click', ()=>{
    if(sliderUrls.length==0) return;
    if(confirm('Delete current image?')){
      const urlToDelete = sliderUrls[currentSlider];
      // Find key
      db.ref('slider').orderByChild('url').equalTo(urlToDelete).once('value').then(snap=>{
        snap.forEach(child=>{
          child.ref.remove().then(()=>{ alert('Deleted!'); loadSlider(); });
        });
      });
    }
  });
</script>

</body>
</html>
