<!DOCTYPE html>
<html lang="hi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>ZaraFix All Service</title>

<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-storage.js"></script>

<style>
body {
  margin: 0;
  font-family: Arial, sans-serif;
  background: #f4f4f4;
  overflow: hidden; /* scrolling lock */
}

/* Header */
header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 10px 20px;
  background: white;
  box-shadow: 0 2px 5px rgba(0,0,0,0.1);
}

.logo {
  font-size: 3rem;
  font-weight: bold;
  background: linear-gradient(45deg, red, orange, yellow, green, blue, indigo, violet);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  text-shadow: 3px 3px 6px rgba(0,0,0,0.4);
  transform: perspective(500px) rotateX(10deg);
}

/* Dropdown Menu */
nav {
  position: relative;
}

nav button {
  background: #007bff;
  color: white;
  padding: 8px 15px;
  border: none;
  border-radius: 5px;
  cursor: pointer;
}

nav ul {
  position: absolute;
  top: 100%;
  left: 0;
  list-style: none;
  margin: 0;
  padding: 5px 0;
  background: white;
  border: 1px solid #ccc;
  display: none;
}

nav:hover ul {
  display: block;
}

nav ul li {
  padding: 8px 20px;
}

nav ul li a {
  text-decoration: none;
  color: #333;
}

/* Slider */
.slider {
  width: 100%;
  height: calc(100vh - 80px);
  background: linear-gradient(135deg, #a8edea, #fed6e3);
  display: flex;
  align-items: center;
  justify-content: center;
  position: relative;
}

.slider img {
  max-width: 90%;
  max-height: 90%;
  object-fit: contain;
  border: none;
  box-shadow: none;
}

/* Delete Button inside slider */
.delete-btn {
  position: absolute;
  top: 20px;
  right: 20px;
  padding: 6px 12px;
  border: none;
  background: #dc3545;
  color: white;
  border-radius: 5px;
  cursor: pointer;
  display: none;
}

/* Progress */
#uploadProgress {
  position: absolute;
  bottom: 20px;
  background: rgba(255,255,255,0.8);
  padding: 5px 15px;
  border-radius: 10px;
  font-weight: bold;
}
</style>
</head>

<body>

<header>
  <div style="display:flex; align-items:center; gap:20px;">
    <div class="logo">ZaraFix</div>
    <nav>
      <button>Menu</button>
      <ul>
        <li><a href="#">Home</a></li>
        <li><a href="#">Services</a></li>
        <li><a href="#">Contact</a></li>
        <li><a href="#">About</a></li>
      </ul>
    </nav>
  </div>
  <div>
    <button id="loginBtn">Login with Google</button>
    <button id="logoutBtn" style="display:none;">Logout</button>
    <button id="adminUploadBtn" style="display:none; background:#28a745; color:white; padding:6px 12px; border:none; border-radius:5px;">Upload Image</button>
  </div>
</header>

<div class="slider" id="imageSlider">
  <button class="delete-btn" id="adminDeleteBtn">Delete</button>
  <div id="uploadProgress"></div>
</div>

<script>
// Firebase config
const firebaseConfig = {
  apiKey: "AIzaSyD7ZqL-PVuFdd8rMVIyW7CgHQjPRGHD2h8",
  authDomain: "zara-fix-2e35a.firebaseapp.com",
  projectId: "zara-fix-2e35a",
  storageBucket: "zara-fix-2e35a.appspot.com",
  messagingSenderId: "636550144008",
  appId: "1:636550144008:web:a849496ad1d1557d7ab1bd"
};
firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();
const storage = firebase.storage();

const adminEmail = "zarasamajiksevasanstha@gmail.com";
let sliderImages = [];
let currentIndex = 0;

// Login
document.getElementById('loginBtn').onclick = () => {
  const provider = new firebase.auth.GoogleAuthProvider();
  auth.signInWithPopup(provider).catch(console.error);
};

// Logout
document.getElementById('logoutBtn').onclick = () => auth.signOut();

// Auth state
auth.onAuthStateChanged(user => {
  if (user) {
    document.getElementById('loginBtn').style.display = "none";
    document.getElementById('logoutBtn').style.display = "inline-block";
    if (user.email === adminEmail) {
      document.getElementById('adminUploadBtn').style.display = "inline-block";
      document.getElementById('adminDeleteBtn').style.display = "inline-block";
    }
  } else {
    document.getElementById('loginBtn').style.display = "inline-block";
    document.getElementById('logoutBtn').style.display = "none";
    document.getElementById('adminUploadBtn').style.display = "none";
    document.getElementById('adminDeleteBtn').style.display = "none";
  }
});

// Upload
document.getElementById('adminUploadBtn').onclick = () => {
  let input = document.createElement('input');
  input.type = "file";
  input.accept = "image/*";
  input.onchange = async () => {
    const file = input.files[0];
    if (!file) return;

    const progressDiv = document.getElementById('uploadProgress');
    progressDiv.innerText = "Uploading... 0%";

    const storageRef = storage.ref('slider/' + Date.now() + "_" + file.name);
    const uploadTask = storageRef.put(file);

    uploadTask.on('state_changed',
      (snapshot) => {
        let progress = (snapshot.bytesTransferred / snapshot.totalBytes) * 100;
        progressDiv.innerText = `Uploading... ${Math.round(progress)}%`;
      },
      (error) => {
        console.error(error);
        progressDiv.innerText = "Upload Failed!";
      },
      () => {
        progressDiv.innerText = "Upload Complete!";
        setTimeout(() => progressDiv.innerText = "", 2000);
        loadSliderImages();
      }
    );
  };
  input.click();
};

// Delete
document.getElementById('adminDeleteBtn').onclick = async () => {
  if (sliderImages.length === 0) return;
  const imgUrl = sliderImages[currentIndex];
  const filePath = decodeURIComponent(imgUrl.split("/o/")[1].split("?")[0]);
  await storage.ref(filePath).delete();
  loadSliderImages();
};

// Load images
async function loadSliderImages() {
  sliderImages = [];
  const sliderDiv = document.getElementById('imageSlider');
  sliderDiv.querySelectorAll('img').forEach(img => img.remove());
  const list = await storage.ref('slider').listAll();
  for (let item of list.items) {
    const url = await item.getDownloadURL();
    sliderImages.push(url);
  }
  showImage();
}

function showImage() {
  if (sliderImages.length === 0) return;
  const sliderDiv = document.getElementById('imageSlider');
  sliderDiv.querySelectorAll('img').forEach(img => img.remove());
  const img = document.createElement('img');
  img.src = sliderImages[currentIndex];
  sliderDiv.appendChild(img);
}

setInterval(() => {
  if (sliderImages.length > 1) {
    currentIndex = (currentIndex + 1) % sliderImages.length;
    showImage();
  }
}, 3000);

loadSliderImages();
</script>
</body>
</html>
