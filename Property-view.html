<!DOCTYPE html>
<html lang="hi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Zara Property Listing</title>
<style>
  body { font-family: Arial, sans-serif; margin:0; padding:0; background:#f5f5f5;}
  header { display:flex; justify-content:space-between; align-items:center; padding:10px 20px; background:#fff; box-shadow:0 2px 5px rgba(0,0,0,0.1);}
  header h1 { margin:0; color:#333; }
  button { padding:8px 12px; border:none; border-radius:5px; cursor:pointer; background:#007bff; color:#fff; }
  #properties { display:flex; flex-wrap:wrap; gap:20px; padding:20px; justify-content:center;}
  .card { background:#fff; width:300px; border-radius:10px; box-shadow:0 3px 6px rgba(0,0,0,0.1); overflow:hidden; display:flex; flex-direction:column; }
  .card img { width:100%; height:200px; object-fit:contain; background:#eee;}
  .card-content { padding:15px; flex:1;}
  .card-content h3 { margin:0 0 10px;}
  .card-content p { margin:5px 0;}
  .card-actions { display:flex; justify-content:space-between; padding:10px; }
  .admin-btn { background:#28a745; }
  .delete-btn { background:#dc3545; }
  #loginBtn, #logoutBtn { margin-left:10px; }
</style>
<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>

</head>
<body>

<header>
  <h1>Zara Property Listing</h1>
  <div>
    <button id="loginBtn">Login with Google</button>
    <button id="logoutBtn" style="display:none;">Logout</button>
  </div>
</header>

<div id="properties"></div>

<script>
  // Firebase Config
  const firebaseConfig = {
    apiKey: "AIzaSyDTj2n1yhr1sFmuyBZ-jUwOmx1YqAN5QjA",
    authDomain: "property-20d6d.firebaseapp.com",
    databaseURL: "https://property-20d6d-default-rtdb.firebaseio.com",
    projectId: "property-20d6d",
    storageBucket: "property-20d6d.appspot.com",
    messagingSenderId: "916859697394",
    appId: "1:916859697394:web:2a8f9ad2d62f8306dcb86b"
  };
  firebase.initializeApp(firebaseConfig);

  const auth = firebase.auth();
  const db = firebase.database();

  const admins = {"admin@example.com": true}; // अपना admin email यहाँ डालो

  const loginBtn = document.getElementById('loginBtn');
  const logoutBtn = document.getElementById('logoutBtn');
  const propertiesDiv = document.getElementById('properties');

  let currentUser = null;

  loginBtn.onclick = () => {
    const provider = new firebase.auth.GoogleAuthProvider();
    auth.signInWithPopup(provider);
  };

  logoutBtn.onclick = () => {
    auth.signOut();
  };

  auth.onAuthStateChanged(user => {
    currentUser = user;
    if(user){
      loginBtn.style.display='none';
      logoutBtn.style.display='inline-block';
    } else {
      loginBtn.style.display='inline-block';
      logoutBtn.style.display='none';
    }
    fetchProperties();
  });

  function fetchProperties(){
    propertiesDiv.innerHTML = '';
    db.ref('properties').once('value').then(snapshot => {
      const data = snapshot.val();
      for(let key in data){
        const prop = data[key];
        if(!prop.approved && (!currentUser || !admins[currentUser.email])) continue;

        const card = document.createElement('div');
        card.className='card';

        const img = document.createElement('img');
        img.src = prop.imageUrl;
        card.appendChild(img);

        const content = document.createElement('div');
        content.className='card-content';
        content.innerHTML = `<h3>${prop.title}</h3>
                             <p><strong>City:</strong> ${prop.city}</p>
                             <p><strong>Type:</strong> ${prop.type}</p>
                             <p><strong>Price:</strong> ₹${prop.price}</p>
                             <p>${prop.description}</p>
                             <p><a href="https://wa.me/${prop.whatsapp}" target="_blank">WhatsApp Poster</a></p>`;
        card.appendChild(content);

        // Admin buttons
        if(currentUser && admins[currentUser.email]){
          const actions = document.createElement('div');
          actions.className='card-actions';
          const approveBtn = document.createElement('button');
          approveBtn.className='admin-btn';
          approveBtn.innerText='Approve';
          approveBtn.onclick = () => {
            db.ref('properties/'+key+'/approved').set(true);
            fetchProperties();
          };
          const deleteBtn = document.createElement('button');
          deleteBtn.className='delete-btn';
          deleteBtn.innerText='Delete';
          deleteBtn.onclick = () => {
            db.ref('properties/'+key).remove();
            fetchProperties();
          };
          actions.appendChild(approveBtn);
          actions.appendChild(deleteBtn);
          card.appendChild(actions);
        }

        propertiesDiv.appendChild(card);
      }
    });
  }
</script>

</body>
</html>
