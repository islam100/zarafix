<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Zara Real Estate</title>
<style>
  body{margin:0;font-family:Arial,sans-serif;background:#f0f2f5;}
  header{display:flex;justify-content:space-between;align-items:center;padding:10px 20px;background:#222;color:#fff;box-shadow:0 4px 10px rgba(0,0,0,0.3);}
  #logo{font-weight:bold;font-size:22px;color:#ff9800;text-shadow:2px 2px 5px #000;}
  #loginBtn,#logoutBtn{padding:10px 18px;background:#43cea2;color:#fff;border:none;border-radius:10px;cursor:pointer;box-shadow:0 4px 6px rgba(0,0,0,0.2);}
  .container{max-width:1200px;margin:20px auto;padding:0 10px;}
  #propertyFormContainer{background:#fff;padding:20px;border-radius:15px;box-shadow:0 4px 10px rgba(0,0,0,0.1);margin-bottom:20px;}
  #propertyForm input,#propertyForm select{width:100%;padding:8px;margin:8px 0;border-radius:8px;border:1px solid #ccc;}
  #propertyForm button{padding:12px 20px;background:linear-gradient(to right,#43cea2,#185a9d);color:#fff;border:none;border-radius:12px;font-weight:bold;cursor:pointer;box-shadow:0 4px 6px rgba(0,0,0,0.2);}
  #cardsContainer{display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:15px;}
  .card{background:#fff;padding:15px;border-radius:15px;box-shadow:0 4px 12px rgba(0,0,0,0.2);position:relative;cursor:pointer;transition:transform 0.3s;}
  .card:hover{transform:scale(1.02);}
  .card img{width:100%;border-radius:10px;margin:5px 0;height:150px;object-fit:cover;}
  .whatsappBtn{padding:8px 12px;background:#25D366;color:#fff;border:none;border-radius:10px;font-weight:bold;cursor:pointer;box-shadow:0 4px 6px rgba(0,0,0,0.2);}
  .approveBtn,.rejectBtn{padding:8px 12px;margin:5px;background:#43cea2;color:#fff;border:none;border-radius:10px;font-weight:bold;cursor:pointer;box-shadow:0 4px 6px rgba(0,0,0,0.2);}
  .rejectBtn{background:#ff4b5c;}
  .led{width:15px;height:15px;border-radius:50%;position:absolute;top:10px;right:10px;}
  .led.yellow{background:yellow;animation:blink 1s infinite;}
  .led.green{background:green;}
  @keyframes blink{0%,50%,100%{opacity:1;}25%,75%{opacity:0;}}
  #fullscreenOverlay{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.9);justify-content:center;align-items:center;z-index:999;}
  #fullscreenOverlay img{max-width:90%;max-height:90%;border-radius:15px;box-shadow:0 4px 12px rgba(0,0,0,0.5);}
  #pagination{margin:20px 0;display:flex;justify-content:center;gap:10px;}
  #pagination button{padding:10px 15px;border:none;border-radius:10px;background:#43cea2;color:#fff;cursor:pointer;box-shadow:0 3px 6px rgba(0,0,0,0.2);}
</style>
</head>
<body>

<header>
  <div id="logo">Zara</div>
  <div>
    <button id="loginBtn">Login</button>
    <button id="logoutBtn" style="display:none;">Logout</button>
  </div>
</header>

<div class="container">
  <div id="propertyFormContainer" style="display:none;">
    <h2>Post Property</h2>
    <form id="propertyForm">
      <input type="text" id="title" placeholder="Property Title" required>
      <select id="type" required>
        <option value="Sell">Sell</option>
        <option value="Rent">Rent</option>
      </select>
      <input type="number" id="price" placeholder="Price" required>
      <input type="text" id="location" placeholder="Location" required>
      <input type="file" id="images" accept="image/*" multiple required>
      <button type="submit">Submit</button>
    </form>
  </div>

  <div id="cardsContainer"></div>

  <div id="pagination">
    <button id="prevPage">Prev</button>
    <button id="nextPage">Next</button>
  </div>
</div>

<div id="fullscreenOverlay"></div>

<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database-compat.js"></script>
<script>
const firebaseConfig = {
  apiKey: "AIzaSyDTj2n1yhr1sFmuyBZ-jUwOmx1YqAN5QjA",
  authDomain: "property-20d6d.firebaseapp.com",
  databaseURL: "https://property-20d6d-default-rtdb.firebaseio.com",
  projectId: "property-20d6d",
  storageBucket: "property-20d6d.appspot.com",
  messagingSenderId: "916859697394",
  appId: "1:916859697394:web:2a8f9ad2d62f8306dcb86b"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.database();
const imgbbApiKey="cad1f0dbfbd25346460789376cc2d7d5";

let currentUser=null;
let postsPerPage=10;
let currentPage=1;
let allProperties=[];

const loginBtn=document.getElementById("loginBtn");
const logoutBtn=document.getElementById("logoutBtn");
const formContainer=document.getElementById("propertyFormContainer");
const cardsContainer=document.getElementById("cardsContainer");
const fullscreenOverlay=document.getElementById("fullscreenOverlay");

loginBtn.onclick=()=>{currentUser="poster1"; loginBtn.style.display="none"; logoutBtn.style.display="inline-block"; formContainer.style.display="block"; loadProperties();}
logoutBtn.onclick=()=>{currentUser=null; loginBtn.style.display="inline-block"; logoutBtn.style.display="none"; formContainer.style.display="none"; renderCards();}

document.getElementById("propertyForm").addEventListener("submit",async e=>{
  e.preventDefault();
  const title=document.getElementById("title").value;
  const type=document.getElementById("type").value;
  const price=document.getElementById("price").value;
  const location=document.getElementById("location").value;
  const files=document.getElementById("images").files;
  if(files.length>5){alert("Max 5 images"); return;}
  let images=[];
  for(let file of files){
    let formData=new FormData();
    formData.append("image",file);
    let res=await fetch(`https://api.imgbb.com/1/upload?key=${imgbbApiKey}`,{method:"POST",body:formData});
    let data=await res.json();
    if(data.success) images.push(data.data.url);
  }
  const id=Date.now();
  db.ref("properties/"+id).set({title,type,price,location,images,user:currentUser,status:"Pending"});
  alert("Property posted!");
  document.getElementById("propertyForm").reset();
  loadProperties();
});

// Pagination
document.getElementById("prevPage").onclick=()=>{if(currentPage>1){currentPage--; renderCards();}}
document.getElementById("nextPage").onclick=()=>{let maxPage=Math.ceil(allProperties.length/postsPerPage); if(currentPage<maxPage){currentPage++; renderCards();}}

// Load properties
function loadProperties(){
  db.ref("properties").once("value").then(snap=>{
    allProperties=[];
    snap.forEach(item=>{allProperties.push({...item.val(),id:item.key});});
    renderCards();
  });
}

function renderCards(){
  cardsContainer.innerHTML="";
  let start=(currentPage-1)*postsPerPage;
  let end=start+postsPerPage;
  let pageProps=allProperties.slice(start,end);
  pageProps.forEach(p=>{
    let card=document.createElement("div");
    card.className="card";
    card.innerHTML=`<h3>${p.title}</h3><p>${p.type} - â‚¹${p.price}</p><p>${p.location}</p>
      ${p.images.map(img=>`<img src="${img}">`).join("")}
      ${p.status==="Pending"?'<div class="led yellow"></div>':'<div class="led green"></div>'}
      ${currentUser===p.user?`<button onclick="deletePost('${p.id}')">Delete</button>`:""}
      <button class="whatsappBtn" onclick="window.open('https://wa.me/1234567890')">WhatsApp</button>
      ${currentUser==="admin"?`<button class="approveBtn" onclick="approvePost('${p.id}')">Approve</button><button class="rejectBtn" onclick="rejectPost('${p.id}')">Reject</button>`:""}`;
    card.onclick=(e)=>{if(e.target.tagName!=="BUTTON"){fullscreenOverlay.innerHTML=p.images.map(img=>`<img src="${img}">`).join(""); fullscreenOverlay.style.display="flex";}};
    cardsContainer.appendChild(card);
  });
}

fullscreenOverlay.onclick=()=>{fullscreenOverlay.style.display="none";}

function deletePost(id){if(confirm("Delete post?")){db.ref("properties/"+id).remove(); loadProperties();}}
function approvePost(id){db.ref("properties/"+id).update({status:"Approved"}); loadProperties();}
function rejectPost(id){db.ref("properties/"+id).update({status:"Rejected"}); loadProperties();}

// Initial load
loadProperties();
</script>
</body>
</html>
