<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Admin Dashboard</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f0f4f8;
      margin: 0;
      padding: 20px;
    }
    h1 {
      text-align: center;
      color: #333;
    }
    .navbar {
      display: flex;
      justify-content: center;
      gap: 10px;
      margin-bottom: 20px;
    }
    .navbar button {
      padding: 10px 20px;
      border: none;
      background: linear-gradient(to right, #6a11cb, #2575fc);
      color: white;
      font-weight: bold;
      border-radius: 15px;
      box-shadow: 0 4px 8px rgba(0,0,0,0.3);
      cursor: pointer;
    }
    .navbar button.active {
      background: #333;
    }
    .card {
      background: white;
      padding: 15px;
      margin: 10px 0;
      border-radius: 10px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    }
    .card .info {
      margin-bottom: 10px;
    }
    .card .actions button {
      margin-right: 10px;
      padding: 5px 10px;
      border: none;
      border-radius: 10px;
      cursor: pointer;
      font-weight: bold;
    }
    .approve {
      background: #4caf50;
      color: white;
    }
    .reject {
      background: #f44336;
      color: white;
    }
    .led {
      width: 15px;
      height: 15px;
      border-radius: 50%;
      display: inline-block;
      margin-right: 5px;
    }
    .led.approved {
      background: green;
    }
    .led.pending {
      background: orange;
    }
    .wallet {
      font-weight: bold;
      color: #444;
    }
  </style>
</head>
<body>

<h1>Admin Dashboard</h1>

<div class="navbar">
  <button id="userBtn" class="active">User Dashboard</button>
  <button id="providerBtn">Provider Dashboard</button>
</div>

<div id="content"></div>

<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>

<script>
  // ✅ Firebase Config
  const firebaseConfig = {
    apiKey: "AIzaSyCH17_8W_UPmPt4KqpCaV7BpN6KsA4a67E",
    authDomain: "zara-fix.firebaseapp.com",
    databaseURL: "https://zara-fix-default-rtdb.firebaseio.com",
    projectId: "zara-fix",
    storageBucket: "zara-fix.appspot.com",
    messagingSenderId: "YOUR_MSG_ID",
    appId: "YOUR_APP_ID"
  };
  firebase.initializeApp(firebaseConfig);
  const db = firebase.database();

  const content = document.getElementById("content");
  const userBtn = document.getElementById("userBtn");
  const providerBtn = document.getElementById("providerBtn");

  userBtn.onclick = () => {
    userBtn.classList.add("active");
    providerBtn.classList.remove("active");
    loadUsers();
  };

  providerBtn.onclick = () => {
    providerBtn.classList.add("active");
    userBtn.classList.remove("active");
    loadProviders();
  };

  function loadUsers() {
    content.innerHTML = '';
    db.ref("requests").once("value", snapshot => {
      if (!snapshot.exists()) {
        content.innerHTML = "<p>No user requests found.</p>";
        return;
      }

      snapshot.forEach(child => {
        const data = child.val();
        const card = document.createElement("div");
        card.className = "card";
        card.innerHTML = `
          <div class="info">
            <span class="led ${data.status === "Approved" ? "approved" : "pending"}"></span>
            <strong>${data.name}</strong><br>
            Email: ${data.email}<br>
            Phone: ${data.phone}<br>
            Address: ${data.address}<br>
            Service: ${data.service}<br>
            Problem: ${data.problem}<br>
            Status: ${data.status || 'Pending'}<br>
            Date: ${data.date}
          </div>
          <div class="actions">
            <button class="approve">✅ Approve</button>
            <button class="reject">❌ Reject/Delete</button>
          </div>
        `;
        card.querySelector(".approve").onclick = () => {
          db.ref(`requests/${child.key}`).update({ status: "Approved" });
          loadUsers();
        };
        card.querySelector(".reject").onclick = () => {
          db.ref(`requests/${child.key}`).remove();
          loadUsers();
        };
        content.appendChild(card);
      });
    });
  }

  function loadProviders() {
    content.innerHTML = '';
    db.ref("providers").once("value", snapshot => {
      if (!snapshot.exists()) {
        content.innerHTML = "<p>No providers found.</p>";
        return;
      }

      snapshot.forEach(child => {
        const data = child.val();
        const card = document.createElement("div");
        card.className = "card";
        card.innerHTML = `
          <div class="info">
            <span class="led ${data.status === "Approved" ? "approved" : "pending"}"></span>
            <strong>${data.name}</strong><br>
            Email: ${data.email}<br>
            Phone: ${data.phone}<br>
            Address: ${data.address}<br>
            Category: ${data.category} - ${data.subcategory}<br>
            Wallet: ₹<span class="wallet">${data.wallet || 0}</span><br>
            Status: ${data.status || 'Pending'}<br>
            Joined: ${data.joinedAt}
          </div>
          <div class="actions">
            <button class="approve">✅ Approve</button>
            <button class="reject">❌ Delete</button>
          </div>
        `;
        card.querySelector(".approve").onclick = () => {
          db.ref(`providers/${child.key}`).update({ status: "Approved" });
          loadProviders();
        };
        card.querySelector(".reject").onclick = () => {
          db.ref(`providers/${child.key}`).remove();
          loadProviders();
        };
        content.appendChild(card);
      });
    });
  }

  // Load default
  loadUsers();
</script>
</body>
</html>
