<input type="file" id="imageUpload" />
<button onclick="uploadImage()">Upload</button>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
  import { getAuth, GoogleAuthProvider, signInWithPopup, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-auth.js";
  import { getStorage, ref, uploadBytes, getDownloadURL } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-storage.js";
  import { getDatabase, ref as dbRef, push, set } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-database.js";

const firebaseConfig = {
  apiKey: "AIzaSyAAOYtvC0kiu_vZTYuQ8phPyMqTEFJj9O0",
  authDomain: "new-bike-59133.firebaseapp.com",
  projectId: "new-bike-59133",
  storageBucket: "new-bike-59133.appspot.com",
  messagingSenderId: "966945954091",
  appId: "1:966945954091:web:c1387e3a27af68aef3cd6e"
};


  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);
  const storage = getStorage(app);
  const database = getDatabase(app);

  // Sign in with Google
  const provider = new GoogleAuthProvider();
  signInWithPopup(auth, provider);

  // Upload function
  window.uploadImage = async function() {
    const file = document.getElementById("imageUpload").files[0];
    if (!file) return alert("Please select an image");

    const user = auth.currentUser;
    if (!user) return alert("Please login first");

    const storageRef = ref(storage, "uploads/" + Date.now() + "-" + file.name);
    await uploadBytes(storageRef, file);
    const url = await getDownloadURL(storageRef);

    // save in db as pending
    await push(dbRef(database, "images"), {
      url: url,
      status: "pending",
      uploadedBy: user.email
    });

    alert("Image uploaded successfully (Pending Approval)");
  }
</script>
