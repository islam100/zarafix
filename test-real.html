<!DOCTYPE html>
<html lang="hi">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Zara Fix — Home</title>

<!-- basic styles -->
<style>
  :root{
    --accent-blue:#4285F4;
    --bg-top:#87ceeb;
    --bg-bottom:#e0f7ff;
    --container-max:1100px;
  }
  html,body{height:100%; margin:0; font-family:Inter, "Segoe UI", Arial, sans-serif; -webkit-font-smoothing:antialiased;}
  body{background:linear-gradient(180deg,var(--bg-top) 0%, var(--bg-bottom) 85%); color:#032;}

/* header */
  .site-header{
    display:flex; align-items:center; justify-content:space-between;
    gap:12px; padding:12px 16px; max-width:var(--container-max); margin:0 auto;
  }
  .left-group{display:flex; align-items:center; gap:12px;}
  .logo{
    font-weight:900; font-size:1.6rem; color:#ef0400;
    text-shadow:2px 2px 0 #ffea00, 4px 4px 0 #00f7ff;
    user-select:none;
  }
  .tagline{font-size:0.82rem; color:#053047; margin-top:2px; opacity:0.95;}

/* menu dropdown next to logo */
  .menu-wrap{position:relative;}
  .menu-toggle{
    background:#fff; border:0; padding:8px 10px; border-radius:8px;
    box-shadow:0 6px 14px rgba(0,0,0,0.12); cursor:pointer; font-weight:700;
  }
  .menu-toggle:focus{outline:2px solid rgba(0,123,255,0.18)}
  .menu-list{
    position:absolute; left:0; top:calc(100% + 8px); min-width:220px;
    background:#fff; border-radius:8px; box-shadow:0 8px 30px rgba(0,0,0,0.12);
    display:none; padding:8px 8px; z-index:999;
  }
  .menu-list.show{display:block;}
  .menu-list a{
    display:block; padding:8px 10px; color:#033; text-decoration:none; border-radius:6px; font-weight:600;
  }
  .menu-list a:hover{background:#f3f7fb;}
  .menu-actions{display:flex; gap:6px; padding-top:6px; border-top:1px solid #eee; margin-top:6px;}

/* login button on top-right corner */
  .auth-wrap{display:flex; align-items:center; gap:8px;}
  #googleLoginBtn{
    background:var(--accent-blue); color:#fff; border:0; padding:8px 12px; border-radius:10px; cursor:pointer; font-weight:700;
    box-shadow:0 8px 18px rgba(0,0,0,0.12);
  }
  #userAvatar{width:36px;height:36px;border-radius:50%;object-fit:cover;border:2px solid #fff;display:none;}

/* main hero / central box */
  .main {
    max-width:960px; margin:18px auto; padding:0 16px 36px;
  }
  .hero-box{
    background:#fff; border-radius:14px; overflow:hidden; box-shadow:0 8px 30px rgba(0,0,0,0.12);
    padding:12px;
  }
  .slider{
    width:100%; height:calc(60vw); max-height:420px; background:#ddd; border-radius:10px; overflow:hidden; position:relative;
    display:flex; align-items:center; justify-content:center;
  }
  .slide-img{ width:100%; height:100%; object-fit:cover; transform:translateX(0); transition:transform .6s ease; }

/* admin upload button shown inside hero box (only to admin) */
  #adminUploadBtn{ display:none; margin-top:10px; background:#28a745;color:#fff;padding:8px 10px;border-radius:8px;border:0;cursor:pointer;font-weight:700;}

/* scrolling text bar */
  .marquee-wrap{ margin-top:16px; background:rgba(255,255,255,0.95); padding:8px 10px; border-radius:10px; overflow:hidden; box-shadow:0 6px 18px rgba(0,0,0,0.06);}
  .marquee{ display:inline-block; white-space:nowrap; padding-left:100%; animation:marquee 18s linear infinite; font-weight:700; color:#023;}
  @keyframes marquee{ 0%{transform:translateX(0%);} 100%{transform:translateX(-100%);} }

/* footer tiny buttons */
  .tiny-footer{display:flex; gap:8px; justify-content:center; margin-top:18px;}
  .tiny-footer button{ padding:6px 10px; border-radius:8px; border:0; font-size:0.78rem; background:#007bff;color:#fff; cursor:pointer;}

/* responsive */
  @media(max-width:720px){
    .logo{ font-size:1.25rem; }
    .menu-list{ min-width:180px; right:0; left:auto; }
    .hero-box{ padding:10px; }
    .slider{ height:180px; max-height:240px; }
  }
</style>
</head>
<body>

<!-- HEADER -->
<header class="site-header" role="banner">
  <div class="left-group" style="align-items:flex-start;">
    <div>
      <div class="logo" id="brandLogo">ZaraFix</div>
      <div class="tagline">All Services - One Place</div>
    </div>

    <!-- MENU DROPDOWN next to logo -->
    <div class="menu-wrap" id="menuWrap">
      <button class="menu-toggle" id="menuToggle" aria-haspopup="true" aria-expanded="false" aria-controls="menuList">Menu ▾</button>
      <div class="menu-list" id="menuList" role="menu" aria-hidden="true">
        <!-- 8 links populated by JS -->
      </div>
    </div>
  </div>

  <!-- top-right auth -->
  <div class="auth-wrap" style="align-items:center;">
    <img id="userAvatar" alt="user avatar" />
    <button id="googleLoginBtn" aria-label="Sign in with Google">Google Login</button>
  </div>
</header>

<!-- MAIN -->
<main class="main" role="main">
  <div class="hero-box">
    <div class="slider" id="imageSlider" aria-live="polite" aria-roledescription="carousel">
      <!-- images injected here -->
      <div id="sliderPlaceholder" style="padding:30px; color:#555; font-weight:700;">No images yet. Admin can upload slider images.</div>
    </div>

    <button id="adminUploadBtn" title="Upload slider images (admin only)">Upload Images (Admin)</button>

    <!-- marquee / scrolling text -->
    <div class="marquee-wrap" aria-hidden="false" style="margin-top:12px;">
      <div class="marquee" id="marqueeText">Welcome to ZaraFix — All Services. Admin can update this announcement text.</div>
    </div>
  </div>

  <!-- small footer buttons -->
  <div class="tiny-footer" style="margin-top:14px;">
    <button id="f1">Btn1</button>
    <button id="f2">Btn2</button>
    <button id="f3">Btn3</button>
  </div>
</main>

<!-- Firebase SDK (app + auth + db + storage for uploads) -->
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-storage.js"></script>

<script>
/* ============================
   CONFIG — बदलें अपनी प्राथमिकताओं के अनुसार
   ============================ */
const firebaseConfig = {
  apiKey: "AIzaSyCH17_8W_UPmPt4KqpCaV7BpN6KsA4a67E",
  authDomain: "zara-fix.firebaseapp.com",
  databaseURL: "https://zara-fix.firebaseio.com",
  projectId: "zara-fix",
  storageBucket: "zara-fix.appspot.com",
  messagingSenderId: "916859697394",
  appId: "1:916859697394:web:0000000000000000"
};
firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();
const db = firebase.database();
const storage = firebase.storage();

const ADMIN_EMAIL = "zarasamajiksevasanstha@gmail.com";

/* ============================
   DOM refs
   ============================ */
const menuToggle = document.getElementById('menuToggle');
const menuList = document.getElementById('menuList');
const menuWrap = document.getElementById('menuWrap');
const googleBtn = document.getElementById('googleLoginBtn');
const userAvatar = document.getElementById('userAvatar');
const adminUploadBtn = document.getElementById('adminUploadBtn');
const imageSlider = document.getElementById('imageSlider');
const sliderPlaceholder = document.getElementById('sliderPlaceholder');
const marqueeText = document.getElementById('marqueeText');

/* ============================
   Menu links — default placeholders (8)
   You or admin can edit these via prompt (admin-only)
   ============================ */
let menuLinks = [
  {text:'Home', href:'#'},
  {text:'Services', href:'#'},
  {text:'Contact', href:'#'},
  {text:'About', href:'#'},
  {text:'Offers', href:'#'},
  {text:'FAQ', href:'#'},
  {text:'Gallery', href:'#'},
  {text:'Help', href:'#'}
];

function renderMenu(){
  menuList.innerHTML = '';
  menuLinks.slice(0,8).forEach((ln,idx)=>{
    const a = document.createElement('a');
    a.href = ln.href || '#';
    a.textContent = ln.text || ('Link '+(idx+1));
    a.setAttribute('role','menuitem');
    menuList.appendChild(a);
  });

  // admin edit control (visible only to admin)
  const adminArea = document.createElement('div');
  adminArea.className = 'menu-actions';
  adminArea.style.display = 'none'; // will enable for admin in auth state
  const editBtn = document.createElement('button');
  editBtn.textContent = 'Edit Links';
  editBtn.style.padding = '6px 8px';
  editBtn.style.borderRadius = '6px';
  editBtn.style.border = 'none';
  editBtn.style.cursor = 'pointer';
  editBtn.addEventListener('click', editMenuLinks);
  adminArea.appendChild(editBtn);
  menuList.appendChild(adminArea);
}

function editMenuLinks(){
  // admin prompt to update up to 8 links
  for(let i=0;i<8;i++){
    const cur = menuLinks[i] || {text:'',href:''};
    const txt = prompt(`Link ${i+1} text:`, cur.text || '');
    if(txt === null) break;
    const href = prompt(`Link ${i+1} URL:`, cur.href || '#');
    if(href === null) break;
    menuLinks[i] = {text: txt.trim() || ('Link '+(i+1)), href: href.trim() || '#'};
  }
  // save to firebase db for persistence
  db.ref('menuLinks').set(menuLinks).then(()=> renderMenu());
}

/* ============================
   Toggle menu (click) — works on mobile too
   ============================ */
menuToggle.addEventListener('click', (e)=>{
  const isOpen = menuList.classList.toggle('show');
  menuToggle.setAttribute('aria-expanded', isOpen ? 'true' : 'false');
  menuList.setAttribute('aria-hidden', isOpen ? 'false' : 'true');
});

// close menu when clicking outside
document.addEventListener('click', (e)=>{
  if(!menuWrap.contains(e.target)){
    menuList.classList.remove('show');
    menuToggle.setAttribute('aria-expanded','false');
    menuList.setAttribute('aria-hidden','true');
  }
});

/* ============================
   Auth (Google Sign-in)
   ============================ */
googleBtn.addEventListener('click', async ()=>{
  try{
    if(auth.currentUser){
      await auth.signOut();
      alert('Logged out');
    } else {
      const provider = new firebase.auth.GoogleAuthProvider();
      await auth.signInWithPopup(provider);
    }
  }catch(err){
    console.error(err);
    alert('Auth error: ' + (err.message || err));
  }
});

auth.onAuthStateChanged(user=>{
  if(user){
    googleBtn.textContent = 'Logout';
    googleBtn.title = 'Sign out';
    userAvatar.src = user.photoURL || '';
    userAvatar.style.display = user.photoURL ? 'inline-block' : 'none';
    // show admin upload if admin email
    if((user.email||'').toLowerCase() === ADMIN_EMAIL.toLowerCase()){
      adminUploadBtn.style.display = 'inline-block';
      // show edit link area in menu
      const adminArea = menuList.querySelector('.menu-actions');
      if(adminArea) adminArea.style.display = 'flex';
    } else {
      adminUploadBtn.style.display = 'none';
      const adminArea = menuList.querySelector('.menu-actions');
      if(adminArea) adminArea.style.display = 'none';
    }
  } else {
    googleBtn.textContent = 'Google Login';
    googleBtn.title = 'Sign in with Google';
    userAvatar.style.display = 'none';
    adminUploadBtn.style.display = 'none';
    const adminArea = menuList.querySelector('.menu-actions');
    if(adminArea) adminArea.style.display = 'none';
  }
});

/* ============================
   slider images: load from firebase storage/db
   admin Upload: multiple images -> upload to storage + save urls in db
   ============================ */

let sliderUrls = []; // cached

async function loadSliderFromDb(){
  try{
    const snap = await db.ref('sliderUrls').once('value');
    const val = snap.val();
    sliderUrls = Array.isArray(val) ? val.filter(Boolean) : (val ? Object.values(val) : []);
    renderSlider();
  }catch(e){
    console.log('slider load err',e);
  }
}

function renderSlider(){
  imageSlider.innerHTML = '';
  if(!sliderUrls || sliderUrls.length === 0){
    imageSlider.appendChild(sliderPlaceholder);
    return;
  }
  sliderUrls.forEach(url=>{
    const img = document.createElement('img');
    img.className = 'slide-img';
    img.src = url;
    imageSlider.appendChild(img);
  });
  startSimpleCarousel();
}

/* simple carousel: translateX */
let carouselTimer = null;
function startSimpleCarousel(){
  const imgs = Array.from(imageSlider.querySelectorAll('.slide-img'));
  if(imgs.length <= 1) return;
  let idx = 0;
  imgs.forEach((im,i)=> im.style.transform = `translateX(${100*(i-idx)}%)`);
  clearInterval(carouselTimer);
  carouselTimer = setInterval(()=>{
    idx = (idx + 1) % imgs.length;
    imgs.forEach((im,i)=> im.style.transform = `translateX(${100*(i-idx)}%)`);
  }, 3000);
}

/* Admin upload */
adminUploadBtn.addEventListener('click', ()=>{
  if(!auth.currentUser || (auth.currentUser.email||'').toLowerCase() !== ADMIN_EMAIL.toLowerCase()){
    return alert('Only admin can upload.');
  }
  const inp = document.createElement('input');
  inp.type = 'file';
  inp.accept = 'image/*';
  inp.multiple = true;
  inp.onchange = async ()=>{
    const files = Array.from(inp.files || []);
    if(files.length === 0) return;
    // show small loader
    adminUploadBtn.disabled = true;
    adminUploadBtn.textContent = 'Uploading...';
    try{
      const uploadedUrls = [];
      for(const f of files){
        const key = 'slider_' + Date.now() + '_' + f.name.replace(/\s+/g,'_');
        const ref = storage.ref('sliderImages/' + key);
        const snap = await ref.put(f);
        const url = await snap.ref.getDownloadURL();
        uploadedUrls.push(url);
      }
      // append to db array (preserve existing)
      const snap = await db.ref('sliderUrls').once('value');
      const existing = snap.val() || [];
      const newArr = existing.concat(uploadedUrls);
      await db.ref('sliderUrls').set(newArr);
      // re-load
      await loadSliderFromDb();
      alert('Upload successful!');
    }catch(err){
      console.error(err);
      alert('Upload failed: ' + (err.message || err));
    }finally{
      adminUploadBtn.disabled = false;
      adminUploadBtn.textContent = 'Upload Images (Admin)';
    }
  };
  inp.click();
});

/* marquee text stored in db (admin can update in console or you may build UI later) */
db.ref('marqueeText').on('value', snap=>{
  const val = snap.val();
  if(val) marqueeText.textContent = val;
});

/* menu links persisted in db */
db.ref('menuLinks').on('value', snap=>{
  const val = snap.val();
  if(Array.isArray(val)) menuLinks = val;
  else if(val && typeof val === 'object') menuLinks = Object.values(val);
  renderMenu();
});

/* initial render */
renderMenu();
loadSliderFromDb();

/* click handlers for tiny footer */
document.getElementById('f1').addEventListener('click',()=>alert('Btn1'));
document.getElementById('f2').addEventListener('click',()=>alert('Btn2'));
document.getElementById('f3').addEventListener('click',()=>alert('Btn3'));

/* close menu on escape */
document.addEventListener('keydown', (e)=> {
  if(e.key === 'Escape'){
    menuList.classList.remove('show');
    menuToggle.setAttribute('aria-expanded','false');
    menuList.setAttribute('aria-hidden','true');
  }
});
</script>
</body>
</html>
