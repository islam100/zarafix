<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>ZaraFix Service Portal</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

  <style>
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background: linear-gradient(120deg, #ffecd2, #fcb69f, #c9ffbf, #ffafbd);
      background-size: 400% 400%;
      animation: gradientBG 12s ease infinite;
    }
    @keyframes gradientBG {
      0% {background-position:0% 50%}
      50% {background-position:100% 50%}
      100% {background-position:0% 50%}
    }

    header {
      background: linear-gradient(135deg, #00c6ff, #0072ff);
      color: white;
      padding: 15px;
      text-align: center;
      font-size: 28px;
      font-weight: bold;
      text-shadow: 2px 2px 6px rgba(0,0,0,0.5);
      border-bottom: 5px solid #fff;
    }
    header span {
      display: inline-block;
      transform: rotateX(15deg) rotateY(10deg);
      color: #fff;
      font-size: 34px;
      letter-spacing: 3px;
      text-shadow: 2px 4px 8px rgba(0,0,0,0.6);
    }

    .btn {
      padding: 10px 18px;
      border: none;
      border-radius: 12px;
      font-weight: bold;
      margin: 8px;
      cursor: pointer;
      transition: transform 0.2s ease, box-shadow 0.3s ease;
      color: white;
      box-shadow: 2px 4px 10px rgba(0,0,0,0.3);
    }
    .btn:hover {
      transform: scale(1.07);
      box-shadow: 4px 8px 15px rgba(0,0,0,0.4);
    }
    .btn-post {background: linear-gradient(135deg,#ff416c,#ff4b2b);}
    .btn-whatsapp {background: linear-gradient(135deg,#25D366,#128C7E);}
    .btn-approve {background: linear-gradient(135deg,#56ab2f,#a8e063);}
    .btn-reject {background: linear-gradient(135deg,#ff512f,#dd2476);}
    .btn-delete {background: linear-gradient(135deg,#232526,#414345);}

    /* Modal */
    .modal {
      display:none;
      position:fixed;
      top:0;left:0;width:100%;height:100%;
      background:rgba(0,0,0,0.7);
      z-index:1000;
    }
    .modal-content {
      background:#fff;
      margin:8% auto;
      padding:20px;
      width:90%;max-width:450px;
      border-radius:15px;
      box-shadow:0 8px 20px rgba(0,0,0,0.4);
      position:relative;
      animation: pop 0.4s ease;
    }
    @keyframes pop {0%{transform:scale(0.6)}100%{transform:scale(1)}}
    .close {position:absolute;top:10px;right:15px;font-size:22px;cursor:pointer;}

    input,textarea {
      width:100%;
      padding:10px;
      margin:6px 0;
      border-radius:8px;
      border:1px solid #ccc;
      outline:none;
      box-shadow: inset 2px 2px 5px rgba(0,0,0,0.1);
    }

    #listings {
      display:grid;
      grid-template-columns:repeat(auto-fit,minmax(280px,1fr));
      gap:15px;
      padding:15px;
    }
    .card {
      background:#fff;
      border-radius:18px;
      padding:15px;
      box-shadow:0 6px 18px rgba(0,0,0,0.3);
      transition:transform 0.3s ease;
    }
    .card:hover {transform:translateY(-6px);}
    .card h3 {margin-top:0;}
  </style>
</head>
<body>
  <header>
    <span>ZaraFix</span>
  </header>

  <center>
    <button class="btn btn-post" onclick="openForm()">+ Post Service</button>
  </center>

  <!-- Post Form Modal -->
  <div id="postModal" class="modal">
    <div class="modal-content">
      <span class="close" onclick="closeForm()">&times;</span>
      <h2>Post Your Service</h2>
      <form id="postForm">
        <input type="text" id="serviceName" placeholder="Service / Business Name" required>
        <input type="text" id="category" placeholder="Category (Doctor, Plumber...)" required>
        <textarea id="address" placeholder="Address" required></textarea>
        <input type="text" id="whatsapp" placeholder="WhatsApp Number" required>
        <button type="submit" class="btn btn-post">Submit</button>
      </form>
    </div>
  </div>

  <section id="listings"></section>

<script>
  // Firebase config
 const firebaseConfig = {
  apiKey: "AIzaSyD7ZqL-PVuFdd8rMVIyW7CgHQjPRGHD2h8",
  authDomain: "zara-fix-2e35a.firebaseapp.com",
  databaseURL: "https://zara-fix-2e35a-default-rtdb.firebaseio.com",
  projectId: "zara-fix-2e35a",
  storageBucket: "zara-fix-2e35a.appspot.com",
  messagingSenderId: "636550144008",
  appId: "1:636550144008:web:a849496ad1d1557d7ab1bd"
};

  firebase.initializeApp(firebaseConfig);
  const db = firebase.database();

  let currentUser = null;
  let adminUID = "ADMIN_UID_HERE"; // replace with actual admin uid

  firebase.auth().onAuthStateChanged(user=>{
    currentUser=user;
    loadListings();
  });

  function openForm(){document.getElementById("postModal").style.display="block";}
  function closeForm(){document.getElementById("postModal").style.display="none";}

  document.getElementById("postForm").addEventListener("submit",e=>{
    e.preventDefault();
    if(!currentUser){alert("Login first!");return;}
    let data={
      name:document.getElementById("serviceName").value,
      category:document.getElementById("category").value,
      address:document.getElementById("address").value,
      whatsapp:document.getElementById("whatsapp").value,
      uid:currentUser.uid,
      approved:false
    };
    db.ref("services").push(data);
    closeForm();
    alert("Posted successfully! Wait for admin approval.");
    document.getElementById("postForm").reset();
  });

  function loadListings(){
    db.ref("services").on("value",snap=>{
      let html="";
      snap.forEach(child=>{
        let s=child.val(); let key=child.key;
        if(s.approved || (currentUser && currentUser.uid===adminUID)){
          html+=`
          <div class="card">
            <h3>${s.name}</h3>
            <p><b>Category:</b> ${s.category}</p>
            <p><b>Address:</b> ${s.address}</p>
            ${s.approved ? `<a href="https://wa.me/${s.whatsapp}" target="_blank">
              <button class="btn btn-whatsapp">WhatsApp</button></a>` : `<p><i>Pending approval</i></p>`}
        `;
          if(currentUser && currentUser.uid===adminUID){
            html+=`
              <button class="btn btn-approve" onclick="updateStatus('${key}',true)">Approve</button>
              <button class="btn btn-reject" onclick="updateStatus('${key}',false)">Reject</button>
              <button class="btn btn-delete" onclick="deleteService('${key}')">Delete</button>
            `;
          }
          html+=`</div>`;
        }
      });
      document.getElementById("listings").innerHTML=html;
    });
  }

  function updateStatus(key,val){db.ref("services/"+key).update({approved:val});}
  function deleteService(key){db.ref("services/"+key).remove();}
</script>
</body>
</html>
