<!DOCTYPE html>
<html lang="hi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Admin Panel - ZaraFix</title>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
<style>
body { font-family: sans-serif; padding: 20px; background: #f0f0f0;}
button { padding: 10px 15px; margin: 5px; cursor: pointer; border-radius: 5px; background: #25D366; color: white; border: none; }
.card { background: white; padding: 15px; margin: 10px; border-radius: 10px; box-shadow: 0 4px 6px rgba(0,0,0,0.2);}
.card:hover { transform: scale(1.05); transition: 0.3s; }
</style>
</head>
<body>
<h2>Admin Panel</h2>
<button id="googleLoginBtn">Google Login</button>
<div id="listing"></div>

<script>
const firebaseConfig = {
  apiKey: "AIzaSyDTj2n1yhr1sFmuyBZ-jUwOmx1YqAN5QjA",
  authDomain: "property-20d6d.firebaseapp.com",
  databaseURL: "https://property-20d6d-default-rtdb.firebaseio.com",
  projectId: "property-20d6d",
  storageBucket: "property-20d6d.appspot.com",
  messagingSenderId: "916859697394",
  appId: "1:916859697394:web:2a8f9ad2d62f8306dcb86b"
};
firebase.initializeApp(firebaseConfig);

const auth = firebase.auth();
const db = firebase.database();

const loginBtn = document.getElementById('googleLoginBtn');
const listingDiv = document.getElementById('listing');

loginBtn.onclick = () => {
  const provider = new firebase.auth.GoogleAuthProvider();
  auth.signInWithPopup(provider).then(result => {
    alert("Admin Logged In: " + result.user.displayName);
    loadPendingPosts();
  }).catch(console.error);
};

function loadPendingPosts() {
  db.ref('properties').once('value', snapshot => {
    listingDiv.innerHTML = '';
    snapshot.forEach(child => {
      const data = child.val();
      const key = child.key;
      if(data.approved === false){
        const card = document.createElement('div');
        card.className = 'card';
        card.innerHTML = `
          <h3>${data.title}</h3>
          <img src="${data.image}" width="200"/>
          <p>${data.description}</p>
          <button onclick="approvePost('${key}')">Approve</button>
          <button onclick="deletePost('${key}')">Delete</button>
        `;
        listingDiv.appendChild(card);
      }
    });
  });
}

function approvePost(key){
  db.ref('properties/'+key).update({approved:true});
  loadPendingPosts();
}

function deletePost(key){
  db.ref('properties/'+key).remove();
  loadPendingPosts();
}
</script>
</body>
</html>
