<!DOCTYPE html>
<html lang="hi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ZaraFix Property Listing</title>
<style>
body { font-family: Arial, sans-serif; background:#f4f4f4; margin:0; padding:0;}
header { padding:10px; background:#333; color:#fff; text-align:center; font-size:24px; font-weight:bold;}
.container { display:flex; flex-wrap:wrap; justify-content:center; margin:20px;}
.card { background:#fff; margin:10px; width:250px; border-radius:10px; box-shadow:0 4px 8px rgba(0,0,0,0.2); cursor:pointer; overflow:hidden; transition:0.3s; }
.card img { width:100%; height:200px; object-fit:cover; }
.card:hover { transform:scale(1.05); }
.card-content { padding:10px; }
.card-content h3 { margin:5px 0; font-size:18px;}
.card-content p { margin:5px 0; font-size:14px;}
.button-group { display:flex; justify-content:space-between; margin-top:10px;}
.button-group button { padding:5px 10px; border:none; border-radius:5px; cursor:pointer; }
.button-group .whatsapp { background:#25D366; color:#fff;}
.button-group .delete { background:red; color:#fff;}
/* Modal Styles */
.modal { display:none; position:fixed; z-index:1000; left:0; top:0; width:100%; height:100%; overflow:auto; background:rgba(0,0,0,0.8);}
.modal-content { margin:10% auto; display:block; max-width:80%; }
.close { position:absolute; top:20px; right:35px; color:#fff; font-size:40px; font-weight:bold; cursor:pointer; }
</style>
</head>
<body>

<header>ZaraFix Property Listing</header>
<div class="container" id="propertyContainer"></div>

<!-- Modal for image view -->
<div id="imageModal" class="modal">
  <span class="close" id="modalClose">&times;</span>
  <img class="modal-content" id="modalImage">
</div>

<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>

<script>
const firebaseConfig = {
  apiKey: "AIzaSyDTj2n1yhr1sFmuyBZ-jUwOmx1YqAN5QjA",
  authDomain: "property-20d6d.firebaseapp.com",
  databaseURL: "https://property-20d6d-default-rtdb.firebaseio.com",
  projectId: "property-20d6d",
  storageBucket: "property-20d6d.appspot.com",
  messagingSenderId: "916859697394",
  appId: "1:916859697394:web:2a8f9ad2d62f8306dcb86b"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.database();
const auth = firebase.auth();

// Check admin
let isAdmin = false;

// Google login for admin
function loginAdmin() {
  const provider = new firebase.auth.GoogleAuthProvider();
  auth.signInWithPopup(provider).then((result) => {
    const user = result.user;
    // example check: admin email
    if(user.email === "admin@gmail.com") {
      isAdmin = true;
      alert("Admin login successful!");
      fetchProperties();
    } else {
      alert("You are not admin!");
      auth.signOut();
    }
  });
}

// Fetch properties
function fetchProperties() {
  const container = document.getElementById("propertyContainer");
  container.innerHTML = "";
  db.ref("properties").once("value").then(snapshot=>{
    snapshot.forEach(child=>{
      const data = child.val();
      if(data.approved) {
        const card = document.createElement("div");
        card.className = "card";
        card.innerHTML = `
          <img src="${data.image}" alt="Property" class="card-img">
          <div class="card-content">
            <h3>${data.title}</h3>
            <p>${data.description}</p>
            <div class="button-group">
              <button class="whatsapp" onclick="window.open('https://wa.me/${data.whatsapp}')">WhatsApp</button>
              ${isAdmin ? `<button class="delete" onclick="deleteProperty('${child.key}')">Delete</button>` : ""}
            </div>
          </div>`;
        container.appendChild(card);

        // Click image to open modal
        const img = card.querySelector(".card-img");
        img.addEventListener("click", ()=>{
          document.getElementById("imageModal").style.display="block";
          document.getElementById("modalImage").src = data.image;
        });
      }
    });
  });
}

// Delete property
function deleteProperty(key) {
  if(confirm("Are you sure you want to delete this property?")) {
    db.ref("properties/"+key).remove();
    fetchProperties();
  }
}

// Modal close
document.getElementById("modalClose").onclick = function() {
  document.getElementById("imageModal").style.display="none";
}

// Initial fetch
fetchProperties();
</script>

<!-- Optional: Admin login button -->
<div style="text-align:center; margin:20px;">
  <button onclick="loginAdmin()">Admin Login</button>
</div>

</body>
</html>
